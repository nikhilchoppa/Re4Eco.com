(function(a){function n(){a('#estimation_popup.lfb_customerAccount [data-toggle="tooltip"]').b_tooltip({});a('#lfb_custAccountPanel a[data-action="saveCustomerInfos"]').on("click",p);a('#lfb_custAccountPanel a[data-action="deleteCustomerData"]').on("click",function(){a("#lfb_delDataForm").slideDown()});a('#lfb_custAccountPanel a[data-action="confirmDeleteCustomerData"]').on("click",q);a('#lfb_custAccountPanel a[data-action="downloadCustomerData"]').on("click",r);a('a[data-action="leaveAccount"]').click(t)}
function v(){var a=jQuery("#lfb_manEmailPass").val(),f=!1;jQuery("#lfb_manEmailPass").closest(".form-group").removeClass("has-error");k(a)||(jQuery("#lfb_manEmailPass").closest(".form-group").addClass("has-error"),f=!0);f||jQuery.ajax({url:lfb_dataCust.ajaxurl,type:"post",data:{action:"lfb_forgotPassManD",email:a},success:function(a){a=a.trim();"1"==a?(jQuery("#lfb_winPass").find(".form-group,a.btn").hide(),jQuery("#lfb_winPass").find("#lfb_passLostConfirmation").show(),setTimeout(function(){jQuery("#lfb_winPass").modal("hide");
jQuery("#lfb_winPass").find("#lfb_passLostConfirmation").hide();jQuery("#lfb_winPass").find(".form-group,a.btn").show()},3E3)):jQuery("#lfb_manEmailPass").closest(".form-group").addClass("has-error")}})}function w(){a("#lfb_custAccountLoginPanel").find('a[data-action="loginCustAccount"]').on("click",x);a("#lfb_custAccountForgotPassLink").on("click",function(){a("#lfb_winPass .has-error").removeClass("has-error");a("#lfb_winPass").modal("show");var c=a('#lfb_custAccountLoginPanel [name="email"]').val();
k(c)?a("#lfb_winPass #lfb_manEmailPass").val(c):a("#lfb_winPass #lfb_manEmailPass").val("")})}function x(){var c=a("#lfb_custAccountLoginPanel").find('[name="email"]').val(),f=a("#lfb_custAccountLoginPanel").find('[name="pass"]').val(),d=!1;a("#lfb_custAccountLoginPanel").find(".has-error").removeClass("has-error");k(c)||(d=!0,a("#lfb_custAccountLoginPanel").find('[name="email"]').closest(".form-group").addClass("has-error"));4>f.length&&(d=!0,a("#lfb_custAccountLoginPanel").find('[name="pass"]').closest(".form-group").addClass("has-error"));
d||jQuery.ajax({url:lfb_dataCust.ajaxurl,type:"post",data:{action:"lfb_loginCustomer",email:c,pass:f},success:function(c){1==c.trim()?document.location.href=document.location.href:(a("#lfb_custAccountLoginPanel").find('[name="email"]').closest(".form-group").addClass("has-error"),a("#lfb_custAccountLoginPanel").find('[name="pass"]').closest(".form-group").addClass("has-error"))}})}function k(a){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a)}function y(){jQuery.ajax({url:lfb_dataCust.ajaxurl,type:"post",
data:{action:"lfb_loadCustomerOrders"},success:function(c){c=JSON.parse(c);a("#lfb_customerOrdersTable tbody").html("");for(var f=0;f<c.length;f++){var d=c[f],h=m(d.totalPrice,d.currency,d.currencyPosition,d.decimalsSeparator,d.thousandsSeparator,d.millionSeparator,d.billionsSeparator),g=m(d.totalSubscription,d.currency,d.currencyPosition,d.decimalsSeparator,d.thousandsSeparator,d.millionSeparator,d.billionsSeparator),e=a('<tr data-id="'+d.id+'"></tr>');e.append("<td>"+d.dateLog+"</td>");e.append('<td class="text-right">'+
g+"</td>");e.append('<td class="text-right">'+h+"</td>");e.append("<td>"+d.statusText+"</td>");e.append('<td class="lfb_actionTh"></td>');1==d.contentUser&&e.find(".lfb_actionTh").append('<a href="javascript:" data-action="viewOrder" title="'+lfb_dataCust.customersAc_viewOrder+'" class="btn btn-default btn-circle" data-toggle="tooltip" data-placement="bottom"><span class="fa fa-eye"></span></a><a href="javascript:" data-action="downloadOrder" title="'+lfb_dataCust.customersAc_downloadOrder+'" class="btn btn-default btn-circle" data-toggle="tooltip" data-placement="bottom"><span class="fa fa-file-download"></span></a></td>');
a("#lfb_customerOrdersTable tbody").append(e);e.find('[data-toggle="tooltip"]').b_tooltip({container:"#estimation_popup.lfb_customerAccount",placement:"top"});e.find('a[data-action="viewOrder"]').on("click",function(){a(".tooltip").remove();a("#lfb_delDataForm").slideUp();z(a(this).closest("tr").attr("data-id"))});e.find('a[data-action="downloadOrder"]').on("click",function(){a("#lfb_delDataForm").slideUp();a(".tooltip").remove();A(a(this).closest("tr").attr("data-id"))})}}})}function m(a,f,d,h,g,
e,k){a||(a=0);var b=a=parseFloat(a).toFixed(2).toString();if(-1<a.indexOf(".")){b=a.substr(0,a.indexOf("."));var c=a.substr(a.indexOf(".")+1,2);a=a.replace(".",h);1==c.toString().length&&(c=c.toString()+"0");9<b.length?a=b.substr(0,b.length-9)+k+b.substr(b.length-9,3)+e+b.substr(b.length-6,3)+g+b.substr(b.length-3,b.length)+h+c:6<b.length?a=b.substr(0,b.length-6)+e+b.substr(b.length-6,3)+g+b.substr(b.length-3,b.length)+h+c:3<b.length&&(a=b.substr(0,b.length-3)+g+b.substr(b.length-3,b.length)+h+c)}else 9<
b.length?a=a=b.substr(0,b.length-9)+k+b.substr(b.length-9,3)+e+b.substr(b.length-6,3)+g+b.substr(b.length-3,b.length):6<b.length?a=b.substr(0,b.length-6)+e+b.substr(b.length-6,3)+g+b.substr(b.length-3,b.length):3<b.length&&(a=b.substr(0,b.length-3)+g+b.substr(b.length-3,b.length));return a="left"==d?f.toString()+a.toString():a.toString()+f.toString()}function A(c){a(".tooltip").remove();jQuery.ajax({url:lfb_dataCust.ajaxurl,type:"post",data:{action:"lfb_downloadCustomerOrder",orderID:c},success:function(c){if(1==
c.trim()){var d=window.open(lfb_dataCust.homeUrl+"/index.php?EPFormsBuilder=downloadMyOrder","_blank");"null"!==typeof d&&null!=d&&(a(".tooltip").remove(),d.focus(),setTimeout(function(){a(".tooltip").remove();d.close()},300))}else a('#lfb_customerOrdersTable tbody [data-action="downloadOrder"]').remove()}})}function z(c){jQuery.ajax({url:lfb_dataCust.ajaxurl,type:"post",data:{action:"lfb_viewCustomerOrder",orderID:c},success:function(c){a("#lfb_viewFormPanel").html(c);a("#lfb_viewFormModal").modal("show");
a("#lfb_viewFormPanel [bgcolor]").each(function(){a(this).css({backgroundColor:a(this).attr("bgcolor")})});a("#lfb_viewFormPanel [bordercolor]").each(function(){a(this).css({border:"1px solid "+a(this).attr("bordercolor")})})}})}function p(){a("#lfb_delDataForm").slideUp();var c=!1,f=a("#lfb_accountInfosPanel").find('[name="email"]').val().trim(),d=a("#lfb_accountInfosPanel").find('[name="firstName"]').val().trim(),h=a("#lfb_accountInfosPanel").find('[name="lastName"]').val().trim(),g=a("#lfb_accountInfosPanel").find('[name="phone"]').val().trim(),
e=a("#lfb_accountInfosPanel").find('[name="phoneJob"]').val().trim(),m=a("#lfb_accountInfosPanel").find('[name="job"]').val().trim(),b=a("#lfb_accountInfosPanel").find('[name="company"]').val().trim(),n=a("#lfb_accountInfosPanel").find('[name="url"]').val().trim(),p=a("#lfb_accountInfosPanel").find('[name="address"]').val().trim(),q=a("#lfb_accountInfosPanel").find('[name="city"]').val().trim(),r=a("#lfb_accountInfosPanel").find('[name="state"]').val().trim();a("#lfb_accountInfosPanel").find('[name="country"]').val().trim();
var t=a("#lfb_accountInfosPanel").find('[name="zip"]').val().trim();u&&clearTimeout(u);a("#lfb_accountInfosPanel").find(".has-error").removeClass("has-error");var l=!1;k(f)||(c=!0,a("#lfb_accountInfosPanel").find('[name="email"]').closest(".form-group").addClass("has-error"),l=a("#lfb_accountInfosPanel").find('[name="email"]'));3>d.length&&(c=!0,a("#lfb_accountInfosPanel").find('[name="firstName"]').closest(".form-group").addClass("has-error"),l||(l=a("#lfb_accountInfosPanel").find('[name="firstName"]')));
3>h.length&&(c=!0,a("#lfb_accountInfosPanel").find('[name="lastName"]').closest(".form-group").addClass("has-error"),l||(l=a("#lfb_accountInfosPanel").find('[name="lastName"]')));c?jQuery("body,html").animate({scrollTop:l.offset().top-80},250):(a('#lfb_custAccountPanel a[data-action="saveCustomerInfos"] span.fas').removeClass("fa-save").addClass("fa-spinner"),jQuery.ajax({url:lfb_dataCust.ajaxurl,type:"post",data:{action:"lfb_saveCustomerInfos",email:f,firstName:d,lastName:h,phone:g,phoneJob:e,job:m,
company:b,url:n,address:p,city:q,state:r,zip:t},success:function(b){a('#lfb_custAccountPanel a[data-action="saveCustomerInfos"] span.fas').removeClass("fa-spinner").addClass("fa-check");u=setTimeout(function(){a('#lfb_custAccountPanel a[data-action="saveCustomerInfos"] span.fas').removeClass("fa-check").addClass("fa-save")},2E3)}}))}function q(){jQuery.ajax({url:lfb_dataCust.ajaxurl,type:"post",data:{action:"lfb_confirmDeleteData"},success:function(a){jQuery("#lfb_delDataForm a.btn").hide();jQuery("#lfb_delDataForm").find(".alert").html('<p style="text-align: center;" class="lfb_text-mainColor">'+
lfb_dataCust.txtCustomersDataModifyValidConfirm+"</p>")}})}function r(){jQuery.ajax({url:lfb_dataCust.ajaxurl,type:"post",data:{action:"lfb_downloadDataMan"},success:function(a){a=a.trim();var c=window.open("");c.document.write(a.replace(/\\\\n/g,"\n"));c.focus()}})}function t(){jQuery.ajax({url:lfb_dataCust.ajaxurl,type:"post",data:{action:"lfb_manSignOut"},success:function(a){document.location.href=document.location.href}})}var u=!1;a(document).ready(function(){w();if(0<lfb_dataCust.customerID)y(),
n();else{var c=a('<div class="modal fade" id="lfb_winPass" tabindex="-1" role="dialog" aria-hidden="true"></div>');c.append('<div class="modal-dialog  modal-sm"><div class="modal-content"><div class="modal-header"></div><div class="modal-body"></div></div></div>');c.find(".modal-header").append('<h4 class="modal-title"><i class="fas fa-lock-open"></i>'+lfb_dataCust.txtCustomersDataForgotPassLink+'</h4><a href="javascript:" class="close" data-dismiss="modal" aria-label="Close"><span class="fas fa-times"></span></a>');
c.find(".modal-body").append('<div class="form-group"><div class="input-group"><div class="input-group-addon"><span class="glyphicon glyphicon-envelope"></span></div><input type="text" class="form-control" id="lfb_manEmailPass" placeholder="'+lfb_dataCust.customersDataLabelEmail+'"></div></div>');c.find(".modal-body").append('<a href="javascript:" data-action="sendPass"  class="btn btn-primary"><span class="glyphicon glyphicon-envelope"></span>'+lfb_dataCust.txtCustomersDataForgotPassLink+"</a>");
c.find(".modal-body").append('<p id="lfb_passLostConfirmation"  style="text-align: center;"><span class="fas fa-check"></span><br/>'+lfb_dataCust.txtCustomersDataForgotPassSent+"</p>");a("#estimation_popup").append(c);a("#lfb_winPass").find("#lfb_passLostConfirmation").hide();c.find('a[data-action="sendPass"]').click(v)}})})(jQuery);