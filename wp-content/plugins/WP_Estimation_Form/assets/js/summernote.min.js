!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(window.jQuery)}(function(P){Array.prototype.reduce||(Array.prototype.reduce=function(e){var t,n=Object(this),o=n.length>>>0,i=0;if(2===arguments.length)t=arguments[1];else{for(;i<o&&!(i in n);)i++;if(o<=i)throw new TypeError("Reduce of empty array with no initial value");t=n[i++]}for(;i<o;i++)i in n&&(t=e(t,n[i],i,n));return t}),"function"!=typeof Array.prototype.filter&&(Array.prototype.filter=function(e){for(var t=Object(this),n=t.length>>>0,o=[],i=2<=arguments.length?arguments[1]:void 0,r=0;r<n;r++)if(r in t){var a=t[r];e.call(i,a,r,t)&&o.push(a)}return o}),Array.prototype.map||(Array.prototype.map=function(e,t){var n,o,i;if(null===this)throw new TypeError(" this is null or not defined");var r=Object(this),a=r.length>>>0;if("function"!=typeof e)throw new TypeError(e+" is not a function");for(1<arguments.length&&(n=t),o=new Array(a),i=0;i<a;){var s,l;i in r&&(s=r[i],l=e.call(n,s,i,r),o[i]=l),i++}return o});var e,t="function"==typeof define&&define.amd,n=navigator.userAgent,o=/MSIE|Trident/i.test(n);if(o){var i=/MSIE (\d+[.]\d+)/.exec(n);i&&(e=parseFloat(i[1])),(i=/Trident\/.*rv:([0-9]{1,}[\.0-9]{0,})/.exec(n))&&(e=parseFloat(i[1]))}var r,L={isMac:-1<navigator.appVersion.indexOf("Mac"),isMSIE:o,isFF:/firefox/i.test(n),isWebkit:/webkit/i.test(n),isSafari:/safari/i.test(n),browserVersion:e,jqueryVersion:parseFloat(P.fn.jquery),isSupportAmd:t,hasCodeMirror:t?require.specified("CodeMirror"):!!window.CodeMirror,isFontInstalled:function(e){var t="Comic Sans MS"===e?"Courier New":"Comic Sans MS",n=P("<div>").css({position:"absolute",left:"-9999px",top:"-9999px",fontSize:"200px"}).text("mmmmmmmmmwwwwwww").appendTo(document.body),o=n.css("fontFamily",t).width(),i=n.css("fontFamily",e+","+t).width();return n.remove(),o!==i},isW3CRangeSupport:!!document.createRange},p=(r=0,{eq:function(t){return function(e){return t===e}},eq2:function(e,t){return e===t},peq2:function(n){return function(e,t){return e[n]===t[n]}},ok:function(){return!0},fail:function(){return!1},self:function(e){return e},not:function(e){return function(){return!e.apply(e,arguments)}},and:function(t,n){return function(e){return t(e)&&n(e)}},uniqueId:function(e){var t=++r+"";return e?e+t:t},rect2bnd:function(e){var t=P(document);return{top:e.top+t.scrollTop(),left:e.left+t.scrollLeft(),width:e.right-e.left,height:e.bottom-e.top}},invertObject:function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[e[n]]=n);return t},namespaceToCamel:function(e,t){return(t=t||"")+e.split(".").map(function(e){return e.substring(0,1).toUpperCase()+e.substring(1)}).join("")}}),v={head:a,last:s,initial:function(e){return e.slice(0,e.length-1)},tail:l,prev:function(e,t){var n=d(e,t);return-1===n?null:e[n-1]},next:function(e,t){var n=d(e,t);return-1===n?null:e[n+1]},find:function(e,t){for(var n=0,o=e.length;n<o;n++){var i=e[n];if(t(i))return i}},contains:c,all:function(e,t){for(var n=0,o=e.length;n<o;n++)if(!t(e[n]))return!1;return!0},sum:function(e,n){return n=n||p.self,e.reduce(function(e,t){return e+n(t)},0)},from:function(e){for(var t=[],n=-1,o=e.length;++n<o;)t[n]=e[n];return t},clusterBy:function(e,o){return e.length?l(e).reduce(function(e,t){var n=s(e);return o(s(n),t)?n[n.length]=t:e[e.length]=[t],e},[[a(e)]]):[]},compact:function(e){for(var t=[],n=0,o=e.length;n<o;n++)e[n]&&t.push(e[n]);return t},unique:function(e){for(var t=[],n=0,o=e.length;n<o;n++)c(t,e[n])||t.push(e[n]);return t}};function a(e){return e[0]}function s(e){return e[e.length-1]}function l(e){return e.slice(1)}function d(e,t){return P.inArray(t,e)}function c(e,t){return-1!==d(e,t)}var u,f,h,m,g,b,y,C,k,x,w,N,T=String.fromCharCode(160),E=(u=I("LI"),f=I("TABLE"),h=function(e){return e&&/^UL|^OL/.test(e.nodeName.toUpperCase())},m=I("HR"),g=I("BLOCKQUOTE"),b=function(e){return H(e)||g(e)||S(e)},y=I("A"),C=I("BODY"),k=L.isMSIE&&L.browserVersion<11?"&nbsp;":"<br>",x=function(e,t){for(;e;){if(t(e))return e;if(S(e))break;e=e.parentNode}return null},w=function(e){for(var t=0;e=e.previousSibling;)t+=1;return t},N=I("TEXTAREA"),{NBSP_CHAR:T,ZERO_WIDTH_NBSP_CHAR:"\ufeff",blank:k,emptyPara:"<p>"+k+"</p>",makePredByNodeName:I,isEditable:S,isControlSizing:function(e){return e&&P(e).hasClass("note-control-sizing")},buildLayoutInfo:F,makeLayoutInfo:function(e){var t,n=P(e).closest(".note-editor, .note-air-editor, .note-air-layout");return n.length?(t=n.is(".note-editor, .note-air-editor")?n:P("#note-editor-"+v.last(n.attr("id").split("-"))),F(t)):null},isText:M,isVoid:R,isPara:A,isPurePara:function(e){return A(e)&&!u(e)},isInline:D,isBlock:p.not(D),isBodyInline:function(e){return D(e)&&!x(e,A)},isBody:C,isParaInline:function(e){return D(e)&&!!x(e,A)},isList:h,isTable:f,isCell:H,isBlockquote:g,isBodyContainer:b,isAnchor:y,isDiv:I("DIV"),isLi:u,isBR:I("BR"),isSpan:I("SPAN"),isB:I("B"),isU:I("U"),isS:I("S"),isI:I("I"),isImg:I("IMG"),isTextarea:N,isEmpty:z,isEmptyAnchor:p.and(y,z),isClosestSibling:function(e,t){return e.nextSibling===t||e.previousSibling===t},withClosestSiblings:function(e,t){t=t||p.ok;var n=[];return e.previousSibling&&t(e.previousSibling)&&n.push(e.previousSibling),n.push(e),e.nextSibling&&t(e.nextSibling)&&n.push(e.nextSibling),n},nodeLength:B,isLeftEdgePoint:q,isRightEdgePoint:W,isEdgePoint:_,isLeftEdgeOf:Z,isRightEdgeOf:G,isLeftEdgePointOf:function(e,t){return q(e)&&Z(e.node,t)},isRightEdgePointOf:function(e,t){return W(e)&&G(e.node,t)},prevPoint:Y,nextPoint:Q,isSamePoint:X,isVisiblePoint:function(e){if(M(e.node)||!J(e.node)||z(e.node))return!0;var t=e.node.childNodes[e.offset-1],n=e.node.childNodes[e.offset];return!(t&&!R(t)||n&&!R(n))},prevPointUntil:function(e,t){for(;e;){if(t(e))return e;e=Y(e)}return null},nextPointUntil:function(e,t){for(;e;){if(t(e))return e;e=Q(e)}return null},isCharPoint:function(e){if(!M(e.node))return!1;var t=e.node.nodeValue.charAt(e.offset-1);return t&&" "!==t&&t!==T},walkPoint:function(e,t,n,o){for(var i=e;i&&(n(i),!X(i,t));){var r=o&&e.node!==i.node&&t.node!==i.node;i=Q(i,r)}},ancestor:x,singleChildAncestor:function(e,t){for(e=e.parentNode;e&&1===B(e);){if(t(e))return e;if(S(e))break;e=e.parentNode}return null},listAncestor:O,lastAncestor:function(e,t){var n=O(e);return v.last(n.filter(t))},listNext:j,listPrev:function(e,t){t=t||p.fail;for(var n=[];e&&!t(e);)n.push(e),e=e.previousSibling;return n},listDescendant:function(i,r){var a=[];return r=r||p.ok,function e(t){i!==t&&r(t)&&a.push(t);for(var n=0,o=t.childNodes.length;n<o;n++)e(t.childNodes[n])}(i),a},commonAncestor:function(e,t){for(var n=O(e),o=t;o;o=o.parentNode)if(-1<P.inArray(o,n))return o;return null},wrap:function(e,t){var n=e.parentNode,o=P("<"+t+">")[0];return n.insertBefore(o,e),o.appendChild(e),o},insertAfter:K,appendChildNodes:V,position:w,hasChildren:J,makeOffsetPath:function(e,t){return O(t,p.eq(e)).map(w).reverse()},fromOffsetPath:function(e,t){for(var n=e,o=0,i=t.length;o<i;o++)n=n.childNodes.length<=t[o]?n.childNodes[n.childNodes.length-1]:n.childNodes[t[o]];return n},splitTree:ee,splitPoint:function(e,t){var n,o,i=t?A:b,r=O(e.node,i),a=v.last(r)||e.node;o=i(a)?(n=r[r.length-2],a):(n=a).parentNode;var s=n&&ee(n,e,{isSkipPaddingBlankHTML:t,isNotSplitEdgePoint:t});return s||o!==e.node||(s=e.node.childNodes[e.offset]),{rightNode:s,container:o}},create:te,createText:function(e){return document.createTextNode(e)},remove:ne,removeWhile:function(e,t){for(;e&&!S(e)&&t(e);){var n=e.parentNode;ne(e),e=n}},replace:function(e,t){if(e.nodeName.toUpperCase()===t.toUpperCase())return e;var n=te(t);return e.style.cssText&&(n.style.cssText=e.style.cssText),V(n,v.from(e.childNodes)),K(n,e),ne(e),n},html:function(e,t){var n=oe(e);return t&&(n=n.replace(/<(\/?)(\b(?!!)[^>\s]*)(.*?)(\s*\/?>)/g,function(e,t,n){n=n.toUpperCase();var o=/^DIV|^TD|^TH|^P|^LI|^H[1-7]/.test(n)&&!!t,i=/^BLOCKQUOTE|^TABLE|^TBODY|^TR|^HR|^UL|^OL/.test(n);return e+(o||i?"\n":"")}),n=P.trim(n)),n},value:oe});function S(e){return e&&P(e).hasClass("note-editable")}function F(n){var e;if(n.hasClass("note-air-editor")){var t=v.last(n.attr("id").split("-"));return{editor:function(){return n},holder:function(){return n.data("holder")},editable:function(){return n},popover:(e=function(e){return function(){return P(e+t)}})("#note-popover-"),handle:e("#note-handle-"),dialog:e("#note-dialog-")}}e=function(e,t){return t=t||n,function(){return t.find(e)}};var o=n.data("options"),i=o&&o.dialogsInBody?P(document.body):null;return{editor:function(){return n},holder:function(){return n.data("holder")},dropzone:e(".note-dropzone"),toolbar:e(".note-toolbar"),editable:e(".note-editable"),codable:e(".note-codable"),statusbar:e(".note-statusbar"),popover:e(".note-popover"),handle:e(".note-handle"),dialog:e(".note-dialog",i)}}function I(t){return t=t.toUpperCase(),function(e){return e&&e.nodeName.toUpperCase()===t}}function M(e){return e&&3===e.nodeType}function R(e){return e&&/^BR|^IMG|^HR|^IFRAME|^BUTTON/.test(e.nodeName.toUpperCase())}function A(e){return!S(e)&&(e&&/^DIV|^P|^LI|^H[1-7]/.test(e.nodeName.toUpperCase()))}function D(e){return!(b(e)||h(e)||m(e)||A(e)||f(e)||g(e))}function H(e){return e&&/^TD|^TH/.test(e.nodeName.toUpperCase())}function B(e){return M(e)?e.nodeValue.length:e.childNodes.length}function z(e){var t=B(e);return 0===t||(!M(e)&&1===t&&e.innerHTML===k||!(!v.all(e.childNodes,M)||""!==e.innerHTML))}function U(e){R(e)||B(e)||(e.innerHTML=k)}function O(e,t){t=t||p.fail;var n=[];return x(e,function(e){return S(e)||n.push(e),t(e)}),n}function j(e,t){t=t||p.fail;for(var n=[];e&&!t(e);)n.push(e),e=e.nextSibling;return n}function K(e,t){var n=t.nextSibling,o=t.parentNode;return n?o.insertBefore(e,n):o.appendChild(e),e}function V(n,e){return P.each(e,function(e,t){n.appendChild(t)}),n}function q(e){return 0===e.offset}function W(e){return e.offset===B(e.node)}function _(e){return q(e)||W(e)}function Z(e,t){for(;e&&e!==t;){if(0!==w(e))return!1;e=e.parentNode}return!0}function G(e,t){for(;e&&e!==t;){if(w(e)!==B(e.parentNode)-1)return!1;e=e.parentNode}return!0}function J(e){return!!(e&&e.childNodes&&e.childNodes.length)}function Y(e,t){var n,o;if(0===e.offset){if(S(e.node))return null;n=e.node.parentNode,o=w(e.node)}else o=J(e.node)?(n=e.node.childNodes[e.offset-1],B(n)):(n=e.node,t?0:e.offset-1);return{node:n,offset:o}}function Q(e,t){var n,o;if(B(e.node)===e.offset){if(S(e.node))return null;n=e.node.parentNode,o=w(e.node)+1}else o=J(e.node)?(n=e.node.childNodes[e.offset],0):(n=e.node,t?B(e.node):e.offset+1);return{node:n,offset:o}}function X(e,t){return e.node===t.node&&e.offset===t.offset}function $(e,t){var n=t&&t.isSkipPaddingBlankHTML,o=t&&t.isNotSplitEdgePoint;if(_(e)&&(M(e.node)||o)){if(q(e))return e.node;if(W(e))return e.node.nextSibling}if(M(e.node))return e.node.splitText(e.offset);var i=e.node.childNodes[e.offset],r=K(e.node.cloneNode(!1),e.node);return V(r,j(i)),n||(U(e.node),U(r)),r}function ee(e,n,o){var t=O(n.node,p.eq(e));return t.length?1===t.length?$(n,o):t.reduce(function(e,t){return e===n.node&&(e=$(n,o)),$({node:t,offset:e?E.position(e):B(t)},o)}):null}function te(e){return document.createElement(e)}function ne(e,t){if(e&&e.parentNode){if(e.removeNode)return e.removeNode(t);var n=e.parentNode;if(!t){var o,i,r=[];for(o=0,i=e.childNodes.length;o<i;o++)r.push(e.childNodes[o]);for(o=0,i=r.length;o<i;o++)n.insertBefore(r[o],e)}n.removeChild(e)}}function oe(e,t){var n=N(e[0])?e.val():e.html();return t?n.replace(/[\n\r]/g,""):n}var ie,re=(ie=function(r,i,a,s){this.sc=r,this.so=i,this.ec=a,this.eo=s;function n(){if(L.isW3CRangeSupport){var e=document.createRange();return e.setStart(r,i),e.setEnd(a,s),e}var t=se({node:r,offset:i});return t.setEndPoint("EndToEnd",se({node:a,offset:s})),t}this.getPoints=function(){return{sc:r,so:i,ec:a,eo:s}},this.getStartPoint=function(){return{node:r,offset:i}},this.getEndPoint=function(){return{node:a,offset:s}},this.select=function(){var e=n();if(L.isW3CRangeSupport){var t=document.getSelection();0<t.rangeCount&&t.removeAllRanges(),t.addRange(e)}else e.select();return this},this.normalize=function(){function e(e,t){if(E.isVisiblePoint(e)&&!E.isEdgePoint(e)||E.isVisiblePoint(e)&&E.isRightEdgePoint(e)&&!t||E.isVisiblePoint(e)&&E.isLeftEdgePoint(e)&&t||E.isVisiblePoint(e)&&E.isBlock(e.node)&&E.isEmpty(e.node))return e;var n=E.ancestor(e.node,E.isBlock);if((E.isLeftEdgePointOf(e,n)||E.isVoid(E.prevPoint(e).node))&&!t||(E.isRightEdgePointOf(e,n)||E.isVoid(E.nextPoint(e).node))&&t){if(E.isVisiblePoint(e))return e;t=!t}return(t?E.nextPointUntil(E.nextPoint(e),E.isVisiblePoint):E.prevPointUntil(E.prevPoint(e),E.isVisiblePoint))||e}var t=e(this.getEndPoint(),!1),n=this.isCollapsed()?t:e(this.getStartPoint(),!0);return new ie(n.node,n.offset,t.node,t.offset)},this.nodes=function(n,e){n=n||p.ok;var o=e&&e.includeAncestor,i=e&&e.fullyContains,t=this.getStartPoint(),r=this.getEndPoint(),a=[],s=[];return E.walkPoint(t,r,function(e){var t;E.isEditable(e.node)||(i?(E.isLeftEdgePoint(e)&&s.push(e.node),E.isRightEdgePoint(e)&&v.contains(s,e.node)&&(t=e.node)):t=o?E.ancestor(e.node,n):e.node,t&&n(t)&&a.push(t))},!0),v.unique(a)},this.commonAncestor=function(){return E.commonAncestor(r,a)},this.expand=function(e){var t=E.ancestor(r,e),n=E.ancestor(a,e);if(!t&&!n)return new ie(r,i,a,s);var o=this.getPoints();return t&&(o.sc=t,o.so=0),n&&(o.ec=n,o.eo=E.nodeLength(n)),new ie(o.sc,o.so,o.ec,o.eo)},this.collapse=function(e){return e?new ie(r,i,r,i):new ie(a,s,a,s)},this.splitText=function(){var e=r===a,t=this.getPoints();return E.isText(a)&&!E.isEdgePoint(this.getEndPoint())&&a.splitText(s),E.isText(r)&&!E.isEdgePoint(this.getStartPoint())&&(t.sc=r.splitText(i),t.so=0,e&&(t.ec=t.sc,t.eo=s-i)),new ie(t.sc,t.so,t.ec,t.eo)},this.deleteContents=function(){if(this.isCollapsed())return this;var e=this.splitText(),t=e.nodes(null,{fullyContains:!0}),o=E.prevPointUntil(e.getStartPoint(),function(e){return!v.contains(t,e.node)}),i=[];return P.each(t,function(e,t){var n=t.parentNode;o.node!==n&&1===E.nodeLength(n)&&i.push(n),E.remove(t,!1)}),P.each(i,function(e,t){E.remove(t,!1)}),new ie(o.node,o.offset,o.node,o.offset).normalize()};function e(t){return function(){var e=E.ancestor(r,t);return!!e&&e===E.ancestor(a,t)}}this.isOnEditable=e(E.isEditable),this.isOnList=e(E.isList),this.isOnAnchor=e(E.isAnchor),this.isOnCell=e(E.isCell),this.isLeftEdgeOf=function(e){if(!E.isLeftEdgePoint(this.getStartPoint()))return!1;var t=E.ancestor(this.sc,e);return t&&E.isLeftEdgeOf(this.sc,t)},this.isCollapsed=function(){return r===a&&i===s},this.wrapBodyInlineWithPara=function(){if(E.isBodyContainer(r)&&E.isEmpty(r))return r.innerHTML=E.emptyPara,new ie(r.firstChild,0,r.firstChild,0);var e,t=this.normalize();if(E.isParaInline(r)||E.isPara(r))return t;if(E.isInline(t.sc)){var n=E.listAncestor(t.sc,p.not(E.isInline));e=v.last(n),E.isInline(e)||(e=n[n.length-2]||t.sc.childNodes[t.so])}else e=t.sc.childNodes[0<t.so?t.so-1:0];var o=E.listPrev(e,E.isParaInline).reverse();if((o=o.concat(E.listNext(e.nextSibling,E.isParaInline))).length){var i=E.wrap(v.head(o),"p");E.appendChildNodes(i,v.tail(o))}return this.normalize()},this.insertNode=function(e){var t=this.wrapBodyInlineWithPara().deleteContents(),n=E.splitPoint(t.getStartPoint(),E.isInline(e));return n.rightNode?n.rightNode.parentNode.insertBefore(e,n.rightNode):n.container.appendChild(e),e},this.pasteHTML=function(e){var t=P("<div></div>").html(e)[0],n=v.from(t.childNodes),o=this.wrapBodyInlineWithPara().deleteContents();return n.reverse().map(function(e){return o.insertNode(e)}).reverse()},this.toString=function(){var e=n();return L.isW3CRangeSupport?e.toString():e.text},this.getWordRange=function(e){var t=this.getEndPoint();if(!E.isCharPoint(t))return this;var n=E.prevPointUntil(t,function(e){return!E.isCharPoint(e)});return e&&(t=E.nextPointUntil(t,function(e){return!E.isCharPoint(e)})),new ie(n.node,n.offset,t.node,t.offset)},this.bookmark=function(e){return{s:{path:E.makeOffsetPath(e,r),offset:i},e:{path:E.makeOffsetPath(e,a),offset:s}}},this.paraBookmark=function(e){return{s:{path:v.tail(E.makeOffsetPath(v.head(e),r)),offset:i},e:{path:v.tail(E.makeOffsetPath(v.last(e),a)),offset:s}}},this.getClientRects=function(){return n().getClientRects()}},{create:function(e,t,n,o){if(arguments.length)2===arguments.length&&(n=e,o=t);else if(L.isW3CRangeSupport){var i=document.getSelection();if(!i||0===i.rangeCount)return null;if(E.isBody(i.anchorNode))return null;var r=i.getRangeAt(0);e=r.startContainer,t=r.startOffset,n=r.endContainer,o=r.endOffset}else{var a=document.selection.createRange(),s=a.duplicate();s.collapse(!1);var l=a;l.collapse(!0);var d=ae(l,!0),c=ae(s,!1);E.isText(d.node)&&E.isLeftEdgePoint(d)&&E.isTextNode(c.node)&&E.isRightEdgePoint(c)&&c.node.nextSibling===d.node&&(d=c),e=d.cont,t=d.offset,n=c.cont,o=c.offset}return new ie(e,t,n,o)},createFromNode:function(e){var t=e,n=0,o=e,i=E.nodeLength(o);return E.isVoid(t)&&(n=E.listPrev(t).length-1,t=t.parentNode),E.isBR(o)?(i=E.listPrev(o).length-1,o=o.parentNode):E.isVoid(o)&&(i=E.listPrev(o).length,o=o.parentNode),this.create(t,n,o,i)},createFromNodeBefore:function(e){return this.createFromNode(e).collapse(!0)},createFromNodeAfter:function(e){return this.createFromNode(e).collapse()},createFromBookmark:function(e,t){var n=E.fromOffsetPath(e,t.s.path),o=t.s.offset,i=E.fromOffsetPath(e,t.e.path),r=t.e.offset;return new ie(n,o,i,r)},createFromParaBookmark:function(e,t){var n=e.s.offset,o=e.e.offset,i=E.fromOffsetPath(v.head(t),e.s.path),r=E.fromOffsetPath(v.last(t),e.e.path);return new ie(i,n,r,o)}});function ae(e,t){var n,o,i=e.parentElement(),r=document.body.createTextRange(),a=v.from(i.childNodes);for(n=0;n<a.length;n++)if(!E.isText(a[n])){if(r.moveToElementText(a[n]),0<=r.compareEndPoints("StartToStart",e))break;o=a[n]}if(0!==n&&E.isText(a[n-1])){var s=document.body.createTextRange(),l=null;s.moveToElementText(o||i),s.collapse(!o),l=o?o.nextSibling:i.firstChild;var d=e.duplicate();d.setEndPoint("StartToStart",s);for(var c=d.text.replace(/[\r\n]/g,"").length;c>l.nodeValue.length&&l.nextSibling;)c-=l.nodeValue.length,l=l.nextSibling;l.nodeValue;t&&l.nextSibling&&E.isText(l.nextSibling)&&c===l.nodeValue.length&&(c-=l.nodeValue.length,l=l.nextSibling),i=l,n=c}return{cont:i,offset:n}}function se(e){var a=function(e,t){var n,o;if(E.isText(e)){var i=E.listPrev(e,p.not(E.isText)),r=v.last(i).previousSibling;n=r||e.parentNode,t+=v.sum(v.tail(i),E.nodeLength),o=!r}else{if(n=e.childNodes[t]||e,E.isText(n))return a(n,0);t=0,o=!1}return{node:n,collapseToStart:o,offset:t}},t=document.body.createTextRange(),n=a(e.node,e.offset);return t.moveToElementText(n.node),t.collapse(n.collapseToStart),t.moveStart("character",n.offset),t}function le(t){function e(e){null!==e.contents&&t.html(e.contents),null!==e.bookmark&&re.createFromBookmark(i,e.bookmark).select()}var n=[],o=-1,i=t[0];this.undo=function(){t.html()!==n[o].contents&&this.recordUndo(),0<o&&e(n[--o])},this.redo=function(){n.length-1>o&&e(n[++o])},this.recordUndo=function(){o++,n.length>o&&(n=n.slice(0,o)),n.push(function(){var e=re.create();return{contents:t.html(),bookmark:e?e.bookmark(i):{s:{path:[],offset:0},e:{path:[],offset:0}}}}())},this.recordUndo()}function de(){this.fromNode=function(e){var t=function(n,e){if(L.jqueryVersion<1.9){var o={};return P.each(e,function(e,t){o[t]=n.css(t)}),o}return n.css.call(n,e)}(e,["font-family","font-size","text-align","list-style-type","line-height"])||{};return t["font-size"]=parseInt(t["font-size"],10),t},this.stylePara=function(e,n){P.each(e.nodes(E.isPara,{includeAncestor:!0}),function(e,t){P(t).css(n)})},this.styleNodes=function(e,t){e=e.splitText();var n=t&&t.nodeName||"SPAN",o=!(!t||!t.expandClosestSibling),i=!(!t||!t.onlyPartialContains);if(e.isCollapsed())return[e.insertNode(E.create(n))];var r=E.makePredByNodeName(n),a=e.nodes(E.isText,{fullyContains:!0}).map(function(e){return E.singleChildAncestor(e,r)||E.wrap(e,n)});if(o){if(i){var s=e.nodes();r=p.and(r,function(e){return v.contains(s,e)})}return a.map(function(e){var t=E.withClosestSiblings(e,r),n=v.head(t),o=v.tail(t);return P.each(o,function(e,t){E.appendChildNodes(n,t.childNodes),E.remove(t)}),v.head(t)})}return a},this.current=function(e){var t=P(E.isText(e.sc)?e.sc.parentNode:e.sc),n=this.fromNode(t);if(n["font-bold"]=document.queryCommandState("bold")?"bold":"normal",n["font-italic"]=document.queryCommandState("italic")?"italic":"normal",n["font-underline"]=document.queryCommandState("underline")?"underline":"normal",n["font-strikethrough"]=document.queryCommandState("strikeThrough")?"strikethrough":"normal",n["font-superscript"]=document.queryCommandState("superscript")?"superscript":"normal",n["font-subscript"]=document.queryCommandState("subscript")?"subscript":"normal",e.isOnList()){var o=-1<P.inArray(n["list-style-type"],["circle","disc","disc-leading-zero","square"]);n["list-style"]=o?"unordered":"ordered"}else n["list-style"]="none";var i=E.ancestor(e.sc,E.isPara);if(i&&i.style["line-height"])n["line-height"]=i.style.lineHeight;else{var r=parseInt(n["line-height"],10)/parseInt(n["font-size"],10);n["line-height"]=r.toFixed(1)}return n.anchor=e.isOnAnchor()&&E.ancestor(e.sc,E.isAnchor),n.ancestors=E.listAncestor(e.sc,E.isEditable),n.range=e,n}}function ce(){this.insertOrderedList=function(){this.toggleList("OL")},this.insertUnorderedList=function(){this.toggleList("UL")},this.indent=function(){var o=this,e=re.create().wrapBodyInlineWithPara(),t=e.nodes(E.isPara,{includeAncestor:!0}),n=v.clusterBy(t,p.peq2("parentNode"));P.each(n,function(e,t){var n=v.head(t);E.isLi(n)?o.wrapList(t,n.parentNode.nodeName):P.each(t,function(e,t){P(t).css("marginLeft",function(e,t){return(parseInt(t,10)||0)+25})})}),e.select()},this.outdent=function(){var o=this,e=re.create().wrapBodyInlineWithPara(),t=e.nodes(E.isPara,{includeAncestor:!0}),n=v.clusterBy(t,p.peq2("parentNode"));P.each(n,function(e,t){var n=v.head(t);E.isLi(n)?o.releaseList([t]):P.each(t,function(e,t){P(t).css("marginLeft",function(e,t){return 25<(t=parseInt(t,10)||0)?t-25:""})})}),e.select()},this.toggleList=function(n){var o=this,e=re.create().wrapBodyInlineWithPara(),t=e.nodes(E.isPara,{includeAncestor:!0}),i=e.paraBookmark(t),r=v.clusterBy(t,p.peq2("parentNode"));if(v.find(t,E.isPurePara)){var a=[];P.each(r,function(e,t){a=a.concat(o.wrapList(t,n))}),t=a}else{var s=e.nodes(E.isList,{includeAncestor:!0}).filter(function(e){return!P.nodeName(e,n)});s.length?P.each(s,function(e,t){E.replace(t,n)}):t=this.releaseList(r,!0)}re.createFromParaBookmark(i,t).select()},this.wrapList=function(e,t){var n=v.head(e),o=v.last(e),i=E.isList(n.previousSibling)&&n.previousSibling,r=E.isList(o.nextSibling)&&o.nextSibling,a=i||E.insertAfter(E.create(t||"UL"),o);return e=e.map(function(e){return E.isPurePara(e)?E.replace(e,"LI"):e}),E.appendChildNodes(a,e),r&&(E.appendChildNodes(a,v.from(r.childNodes)),E.remove(r)),e},this.releaseList=function(e,l){var d=[];return P.each(e,function(e,t){var n=v.head(t),o=v.last(t),i=l?E.lastAncestor(n,E.isList):n.parentNode,r=1<i.childNodes.length?E.splitTree(i,{node:o.parentNode,offset:E.position(o)+1},{isSkipPaddingBlankHTML:!0}):null,a=E.splitTree(i,{node:n.parentNode,offset:E.position(n)},{isSkipPaddingBlankHTML:!0});t=l?E.listDescendant(a,E.isLi):v.from(a.childNodes).filter(E.isLi),!l&&E.isList(i.parentNode)||(t=t.map(function(e){return E.replace(e,"P")})),P.each(v.from(t).reverse(),function(e,t){E.insertAfter(t,i)});var s=v.compact([i,a,r]);P.each(s,function(e,t){var n=[t].concat(E.listDescendant(t,E.isList));P.each(n.reverse(),function(e,t){E.nodeLength(t)||E.remove(t,!0)})}),d=d.concat(t)}),d}}function ue(){var r=new ce;this.insertTab=function(e,t,n){var o=E.createText(new Array(n+1).join(E.NBSP_CHAR));(t=t.deleteContents()).insertNode(o,!0),(t=re.create(o,n)).select()},this.insertParagraph=function(){var e=re.create();e=(e=e.deleteContents()).wrapBodyInlineWithPara();var t,n=E.ancestor(e.sc,E.isPara);if(n){if(E.isEmpty(n)&&E.isLi(n))return void r.toggleList(n.parentNode.nodeName);t=E.splitTree(n,e.getStartPoint());var o=E.listDescendant(n,E.isEmptyAnchor);o=o.concat(E.listDescendant(t,E.isEmptyAnchor)),P.each(o,function(e,t){E.remove(t)})}else{var i=e.sc.childNodes[e.so];t=P(E.emptyPara)[0],i?e.sc.insertBefore(t,i):e.sc.appendChild(t)}re.create(t,0).normalize().select()}}function fe(){this.tab=function(e,t){var n=E.ancestor(e.commonAncestor(),E.isCell),o=E.ancestor(n,E.isTable),i=E.listDescendant(o,E.isCell),r=v[t?"prev":"next"](i,n);r&&re.create(r,0).select()},this.createTable=function(e,t){for(var n,o=[],i=0;i<e;i++)o.push("<td>"+E.blank+"</td>");n=o.join("");for(var r,a=[],s=0;s<t;s++)a.push("<tr>"+n+"</tr>");return r=a.join(""),P('<table class="table table-bordered">'+r+"</table>")[0]}}function he(o){var t=this,f=new de,i=new fe,r=new ue,n=new ce;function a(e){var t=E.makeLayoutInfo(e).holder();o.bindCustomEvent(t,e.data("callbacks"),"before.command")(e.html(),e)}function s(e){var t=E.makeLayoutInfo(e).holder();o.bindCustomEvent(t,e.data("callbacks"),"change")(e.html(),e)}this.createRange=function(e){return this.focus(e),re.create()},this.saveRange=function(e,t){this.focus(e),e.data("range",re.create()),t&&re.create().collapse().select()},this.saveNode=function(e){for(var t=[],n=0,o=e[0].childNodes.length;n<o;n++)t.push(e[0].childNodes[n]);e.data("childNodes",t)},this.restoreRange=function(e){var t=e.data("range");t&&(t.select(),this.focus(e))},this.restoreNode=function(e){e.html("");for(var t=e.data("childNodes"),n=0,o=t.length;n<o;n++)e[0].appendChild(t[n])},this.currentStyle=function(e){var t=re.create(),n=t&&t.isOnEditable()?f.current(t.normalize()):{};return E.isImg(e)&&(n.image=e),n},this.styleFromNode=function(e){return f.fromNode(e)},this.undo=function(e){a(e),e.data("NoteHistory").undo(),s(e)},this.redo=function(e){a(e),e.data("NoteHistory").redo(),s(e)};for(var h=this.beforeCommand=function(e){a(e),t.focus(e)},p=this.afterCommand=function(e,t){e.data("NoteHistory").recordUndo(),t||s(e)},e=["bold","italic","underline","strikethrough","superscript","subscript","justifyLeft","justifyCenter","justifyRight","justifyFull","formatBlock","removeFormat","backColor","foreColor","fontName"],l=0,d=e.length;l<d;l++)this[e[l]]=function(n){return function(e,t){h(e),document.execCommand(n,!1,t),p(e,!0)}}(e[l]);for(this.tab=function(e,t){var n=this.createRange(e);n.isCollapsed()&&n.isOnCell()?i.tab(n):(h(e),r.insertTab(e,n,t.tabsize),p(e))},this.untab=function(e){var t=this.createRange(e);t.isCollapsed()&&t.isOnCell()&&i.tab(t,!0)},this.insertParagraph=function(e){h(e),r.insertParagraph(e),p(e)},this.insertOrderedList=function(e){h(e),n.insertOrderedList(e),p(e)},this.insertUnorderedList=function(e){h(e),n.insertUnorderedList(e),p(e)},this.indent=function(e){h(e),n.indent(e),p(e)},this.outdent=function(e){h(e),n.outdent(e),p(e)},this.insertImage=function(t,e,n){xe.createImage(e,n).then(function(e){h(t),e.css({display:"",width:Math.min(t.width(),e.width())}),re.create().insertNode(e[0]),re.createFromNodeAfter(e[0]).select(),p(t)}).fail(function(){var e=E.makeLayoutInfo(t).holder();o.bindCustomEvent(e,t.data("callbacks"),"image.upload.error")()})},this.insertNode=function(e,t){h(e),re.create().insertNode(t),re.createFromNodeAfter(t).select(),p(e)},this.insertText=function(e,t){h(e);var n=re.create().insertNode(E.createText(t));re.create(n,E.nodeLength(n)).select(),p(e)},this.pasteHTML=function(e,t){h(e);var n=re.create().pasteHTML(t);re.createFromNodeAfter(v.last(n)).select(),p(e)},this.formatBlock=function(e,t){h(e),t=L.isMSIE?"<"+t+">":t,document.execCommand("FormatBlock",!1,t),p(e)},this.formatPara=function(e){h(e),this.formatBlock(e,"P"),p(e)},l=1;l<=6;l++)this["formatH"+l]=function(t){return function(e){this.formatBlock(e,"H"+t)}}(l);this.fontSize=function(e,t){var n=re.create();if(n.isCollapsed()){var o=f.styleNodes(n),i=v.head(o);P(o).css({"font-size":t+"px"}),i&&!E.nodeLength(i)&&(i.innerHTML=E.ZERO_WIDTH_NBSP_CHAR,re.createFromNodeAfter(i.firstChild).select(),e.data(Ne,i))}else h(e),P(f.styleNodes(n)).css({"font-size":t+"px"}),p(e)},this.insertHorizontalRule=function(e){h(e);var t=re.create().insertNode(P("<HR/>")[0]);t.nextSibling&&re.create(t.nextSibling,0).normalize().select(),p(e)},this.removeBogus=function(e){var t=e.data(Ne);if(t){var n=v.find(v.from(t.childNodes),E.isText),o=n.nodeValue.indexOf(E.ZERO_WIDTH_NBSP_CHAR);-1!==o&&n.deleteData(o,1),E.isEmpty(t)&&E.remove(t),e.removeData(Ne)}},this.lineHeight=function(e,t){h(e),f.stylePara(re.create(),{lineHeight:t}),p(e)},this.unlink=function(e){var t=this.createRange(e);if(t.isOnAnchor()){var n=E.ancestor(t.sc,E.isAnchor);(t=re.createFromNode(n)).select(),h(e),document.execCommand("unlink"),p(e)}},this.createLink=function(e,t,n){var o=t.url,i=t.text,r=t.isNewWindow,a=t.range||this.createRange(e),s=a.toString()!==i;n=n||E.makeLayoutInfo(e).editor().data("options"),h(e),n.onCreateLink&&(o=n.onCreateLink(o));var l=[];if(s){var d=a.insertNode(P("<A>"+i+"</A>")[0]);l.push(d)}else l=f.styleNodes(a,{nodeName:"A",expandClosestSibling:!0,onlyPartialContains:!0});P.each(l,function(e,t){P(t).attr("href",o),r?P(t).attr("target","_blank"):P(t).removeAttr("target")});var c=re.createFromNodeBefore(v.head(l)).getStartPoint(),u=re.createFromNodeAfter(v.last(l)).getEndPoint();re.create(c.node,c.offset,u.node,u.offset).select(),p(e)},this.getLinkInfo=function(e){this.focus(e);var t=re.create().expand(E.isAnchor),n=P(v.head(t.nodes(E.isAnchor)));return{range:t,text:t.toString(),isNewWindow:!!n.length&&"_blank"===n.attr("target"),url:n.length?n.attr("href"):""}},this.color=function(e,t){var n=JSON.parse(t),o=n.foreColor,i=n.backColor;h(e),o&&document.execCommand("foreColor",!1,o),i&&document.execCommand("backColor",!1,i),p(e)},this.insertTable=function(e,t){var n=t.split("x");h(e),re.create().deleteContents().insertNode(i.createTable(n[0],n[1])),p(e)},this.floatMe=function(e,t,n){h(e),n.removeClass("pull-left pull-right"),t&&"none"!==t&&n.addClass("pull-"+t),n.css("float",t),p(e)},this.imageShape=function(e,t,n){h(e),n.removeClass("img-rounded img-circle img-thumbnail"),t&&n.addClass(t),p(e)},this.resize=function(e,t,n){h(e),n.css({width:100*t+"%",height:""}),p(e)},this.resizeTo=function(e,t,n){var o;if(n){var i=e.y/e.x,r=t.data("ratio");o={width:i<r?e.x:e.y/r,height:i<r?e.x*r:e.y}}else o={width:e.x,height:e.y};t.css(o)},this.removeMedia=function(e,t,n){h(e),n.detach(),o.bindCustomEvent(P(),e.data("callbacks"),"media.delete")(n,e),p(e)},this.focus=function(e){e.focus(),L.isFF&&!re.create().isOnEditable()&&re.createFromNode(e[0]).normalize().collapse().select()},this.isEmpty=function(e){return E.isEmpty(e[0])||E.emptyPara===e.html()}}function pe(){this.update=function(n,e){function t(e,t){e.find(".dropdown-menu li a").each(function(){var e=P(this).data("value")+""==t+"";this.className=e?"checked":""})}function o(e,t){n.find(e).toggleClass("active",t())}if(e.image){var i=P(e.image);o('button[data-event="imageShape"][data-value="img-rounded"]',function(){return i.hasClass("img-rounded")}),o('button[data-event="imageShape"][data-value="img-circle"]',function(){return i.hasClass("img-circle")}),o('button[data-event="imageShape"][data-value="img-thumbnail"]',function(){return i.hasClass("img-thumbnail")}),o('button[data-event="imageShape"]:not([data-value])',function(){return!i.is(".img-rounded, .img-circle, .img-thumbnail")});var r=i.css("float");o('button[data-event="floatMe"][data-value="left"]',function(){return"left"===r}),o('button[data-event="floatMe"][data-value="right"]',function(){return"right"===r}),o('button[data-event="floatMe"][data-value="none"]',function(){return"left"!==r&&"right"!==r});var a=i.attr("style");return o('button[data-event="resize"][data-value="1"]',function(){return!!/(^|\s)(max-)?width\s*:\s*100%/.test(a)}),o('button[data-event="resize"][data-value="0.5"]',function(){return!!/(^|\s)(max-)?width\s*:\s*50%/.test(a)}),void o('button[data-event="resize"][data-value="0.25"]',function(){return!!/(^|\s)(max-)?width\s*:\s*25%/.test(a)})}var s=n.find(".note-fontname");if(s.length){var l=e["font-family"];if(l){for(var d=l.split(","),c=0,u=d.length;c<u&&(l=d[c].replace(/[\'\"]/g,"").replace(/\s+$/,"").replace(/^\s+/,""),!L.isFontInstalled(l));c++);s.find(".note-current-fontname").text(l),t(s,l)}}var f=n.find(".note-fontsize");f.find(".note-current-fontsize").text(e["font-size"]),t(f,parseFloat(e["font-size"])),t(n.find(".note-height"),parseFloat(e["line-height"])),o('button[data-event="bold"]',function(){return"bold"===e["font-bold"]}),o('button[data-event="italic"]',function(){return"italic"===e["font-italic"]}),o('button[data-event="underline"]',function(){return"underline"===e["font-underline"]}),o('button[data-event="strikethrough"]',function(){return"strikethrough"===e["font-strikethrough"]}),o('button[data-event="superscript"]',function(){return"superscript"===e["font-superscript"]}),o('button[data-event="subscript"]',function(){return"subscript"===e["font-subscript"]}),o('button[data-event="justifyLeft"]',function(){return"left"===e["text-align"]||"start"===e["text-align"]}),o('button[data-event="justifyCenter"]',function(){return"center"===e["text-align"]}),o('button[data-event="justifyRight"]',function(){return"right"===e["text-align"]}),o('button[data-event="justifyFull"]',function(){return"justify"===e["text-align"]}),o('button[data-event="insertUnorderedList"]',function(){return"unordered"===e["list-style"]}),o('button[data-event="insertOrderedList"]',function(){return"ordered"===e["list-style"]})},this.updateRecentColor=function(e,t,n){var o=P(e).closest(".note-color").find(".note-recent-color"),i=JSON.parse(o.attr("data-value"));i[t]=n,o.attr("data-value",JSON.stringify(i));var r="backColor"===t?"background-color":"color";o.find("i").css(r,n)}}function ve(){var o=new pe;this.update=function(e,t){o.update(e,t)},this.updateRecentColor=function(e,t,n){o.updateRecentColor(e,t,n)},this.activate=function(e){e.find("button").not('button[data-event="codeview"]').removeClass("disabled")},this.deactivate=function(e){e.find("button").not('button[data-event="codeview"]').addClass("disabled")},this.updateFullscreen=function(e,t){e.find('button[data-event="fullscreen"]').toggleClass("active",t)},this.updateCodeview=function(e,t){e.find('button[data-event="codeview"]').toggleClass("active",t),t?this.deactivate(e):this.activate(e)},this.get=function(e,t){return E.makeLayoutInfo(e).toolbar().find("[data-name="+t+"]")},this.setButtonState=function(e,t,n){n=!1!==n,this.get(e,t).toggleClass("active",n)}}function me(){var t=P(document);this.attach=function(e,t){t.disableResizeEditor||e.statusbar().on("mousedown",n)};var n=function(e){e.preventDefault(),e.stopPropagation();var n=E.makeLayoutInfo(e.target).editable(),o=n.offset().top-t.scrollTop(),i=E.makeLayoutInfo(e.currentTarget||e.target).editor().data("options");t.on("mousemove",function(e){var t=e.clientY-(24+o);t=0<i.minHeight?Math.max(t,i.minHeight):t,t=0<i.maxHeight?Math.min(t,i.maxHeight):t,n.height(t)}).one("mouseup",function(){t.off("mousemove")})}}function ge(){function u(e,t){var n=t&&t.isAirMode,o=t&&t.isLeftTop,i=P(e),r=n?i.offset():i.position(),a=o?0:i.outerHeight(!0);return{left:r.left,top:r.top+a}}function f(e,t){e.css({display:"block",left:t.left,top:t.top})}var h=new pe;this.update=function(e,t,n){h.update(e,t);var o=e.find(".note-link-popover");if(t.anchor){var i=o.find("a"),r=P(t.anchor).attr("href"),a=P(t.anchor).attr("target");i.attr("href",r).html(r),a?i.attr("target","_blank"):i.removeAttr("target"),f(o,u(t.anchor,{isAirMode:n}))}else o.hide();var s=e.find(".note-image-popover");t.image?f(s,u(t.image,{isAirMode:n,isLeftTop:!0})):s.hide();var l=e.find(".note-air-popover");if(n&&t.range&&!t.range.isCollapsed()){var d=v.last(t.range.getClientRects());if(d){var c=p.rect2bnd(d);f(l,{left:Math.max(c.left+c.width/2-20,0),top:c.top+c.height})}}else l.hide()},this.updateRecentColor=function(e,t,n){e.updateRecentColor(e,t,n)},this.hide=function(e){e.children().hide()}}function be(u){function t(e){if(E.isControlSizing(e.target)){e.preventDefault(),e.stopPropagation();var t=E.makeLayoutInfo(e.target),n=t.handle(),o=t.popover(),i=t.editable(),r=t.editor(),a=n.find(".note-control-selection").data("target"),s=P(a),l=s.offset(),d=f.scrollTop(),c=r.data("options").airMode;f.on("mousemove",function(e){u.invoke("editor.resizeTo",{x:e.clientX-l.left,y:e.clientY-(l.top-d)},s,!e.shiftKey),u.invoke("handle.update",n,{image:a},c),u.invoke("popover.update",o,{image:a},c)}).one("mouseup",function(){f.off("mousemove"),u.invoke("editor.afterCommand",i)}),s.data("ratio")||s.data("ratio",s.height()/s.width())}}var f=P(document);this.attach=function(e){e.handle().on("mousedown",t)},this.update=function(e,t,n){var o=e.find(".note-control-selection");if(t.image){var i=P(t.image),r=n?i.offset():i.position(),a={w:i.outerWidth(!0),h:i.outerHeight(!0)};o.css({display:"block",left:r.left,top:r.top,width:a.w,height:a.h}).data("target",t.image);var s=a.w+"x"+a.h;o.find(".note-control-selection-info").text(s)}else o.hide()},this.hide=function(e){e.children().hide()}}function ye(s){var l=P(window),d=P("html, body");this.toggle=function(e){function t(e){i.css("height",e.h),r.css("height",e.h),r.data("cmeditor")&&r.data("cmeditor").setsize(null,e.h)}var n=e.editor(),o=e.toolbar(),i=e.editable(),r=e.codable();n.toggleClass("fullscreen");var a=n.hasClass("fullscreen");a?(i.data("orgheight",i.css("height")),l.on("resize",function(){t({h:l.height()-o.outerHeight()})}).trigger("resize"),d.css("overflow","hidden")):(l.off("resize"),t({h:i.data("orgheight")}),d.css("overflow","visible")),s.invoke("toolbar.updateFullscreen",o,a)}}var Ce,ke,xe={readFileAsDataURL:function(e){return P.Deferred(function(n){P.extend(new FileReader,{onload:function(e){var t=e.target.result;n.resolve(t)},onerror:function(){n.reject(this)}}).readAsDataURL(e)}).promise()},createImage:function(n,o){return P.Deferred(function(e){var t=P("<img>");t.one("load",function(){t.off("error abort"),e.resolve(t)}).one("error abort",function(){t.off("load").detach(),e.reject(t)}).css({display:"none"}).appendTo(document.body).attr({src:n,"data-filename":o})}).promise()}},we=(Ce={BACKSPACE:8,TAB:9,ENTER:13,SPACE:32,NUM0:48,NUM1:49,NUM2:50,NUM3:51,NUM4:52,NUM5:53,NUM6:54,NUM7:55,NUM8:56,B:66,E:69,I:73,J:74,K:75,L:76,R:82,S:83,U:85,V:86,Y:89,Z:90,SLASH:191,LEFTBRACKET:219,BACKSLASH:220,RIGHTBRACKET:221},{isEdit:function(e){return v.contains([8,9,13,32],e)},isMove:function(e){return v.contains([37,38,39,40],e)},nameFromCode:p.invertObject(Ce),code:Ce}),Ne="bogus";L.hasCodeMirror&&(L.isSupportAmd?require(["CodeMirror"],function(e){ke=e}):ke=window.CodeMirror);function Te(c){this.sync=function(e){c.invoke("codeview.isActivated",e)&&L.hasCodeMirror&&e.codable().data("cmEditor").save()},this.isActivated=function(e){return e.editor().hasClass("codeview")},this.toggle=function(e){this.isActivated(e)?this.deactivate(e):this.activate(e)},this.activate=function(e){var t=e.editor(),n=e.toolbar(),o=e.editable(),i=e.codable(),r=e.popover(),a=e.handle(),s=t.data("options");if(i.val(E.html(o,s.prettifyHtml)),i.height(o.height()),c.invoke("toolbar.updateCodeview",n,!0),c.invoke("popover.hide",r),c.invoke("handle.hide",a),t.addClass("codeview"),i.focus(),L.hasCodeMirror){var l=ke.fromTextArea(i[0],s.codemirror);if(s.codemirror.tern){var d=new ke.TernServer(s.codemirror.tern);l.ternServer=d,l.on("cursorActivity",function(e){d.updateArgHints(e)})}l.setSize(null,o.outerHeight()),i.data("cmEditor",l)}},this.deactivate=function(e){var t=e.holder(),n=e.editor(),o=e.toolbar(),i=e.editable(),r=e.codable(),a=n.data("options");if(L.hasCodeMirror){var s=r.data("cmEditor");r.val(s.getValue()),s.toTextArea()}var l=E.value(r,a.prettifyHtml)||E.emptyPara,d=i.html()!==l;i.html(l),i.height(a.height?r.height():"auto"),n.removeClass("codeview"),d&&c.bindCustomEvent(t,i.data("callbacks"),"change")(i.html(),i),i.focus(),c.invoke("toolbar.updateCodeview",o,!1)}}function Se(d){var n=P(document);this.attach=function(e,t){t.airMode||t.disableDragAndDrop?n.on("drop",function(e){e.preventDefault()}):this.attachDragAndDropEvent(e,t)},this.attachDragAndDropEvent=function(o,i){var r=P(),a=o.editor(),s=o.dropzone(),l=s.find(".note-dropzone-message");n.on("dragenter",function(e){var t=d.invoke("codeview.isActivated",o),n=0<a.width()&&0<a.height();t||r.length||!n||(a.addClass("dragover"),s.width(a.width()),s.height(a.height()),l.text(i.langInfo.image.dragImageHere)),r=r.add(e.target)}).on("dragleave",function(e){(r=r.not(e.target)).length||a.removeClass("dragover")}).on("drop",function(){r=P(),a.removeClass("dragover")}),s.on("dragenter",function(){s.addClass("hover"),l.text(i.langInfo.image.dropImage)}).on("dragleave",function(){s.removeClass("hover"),l.text(i.langInfo.image.dragImageHere)}),s.on("drop",function(e){var t=e.originalEvent.dataTransfer,n=E.makeLayoutInfo(e.currentTarget||e.target);if(t&&t.files&&t.files.length)e.preventDefault(),n.editable().focus(),d.insertImages(n,t.files);else{function o(){n.holder().summernote("insertNode",this)}for(var i=0,r=t.types.length;i<r;i++){var a=t.types[i],s=t.getData(a);-1<a.toLowerCase().indexOf("text")?n.holder().summernote("pasteHTML",s):P(s).each(o)}}}).on("dragover",!1)}}function Pe(d){var c;this.attach=function(t){L.isMSIE&&10<L.browserVersion||L.isFF?(c=P("<div />").attr("contenteditable",!0).css({position:"absolute",left:-1e5,opacity:0}),t.editable().on("keydown",function(e){e.ctrlKey&&e.keyCode===we.code.V&&(d.invoke("saveRange",t.editable()),c.focus(),setTimeout(function(){n(t)},0))}),t.editable().before(c)):t.editable().on("paste",e)};var n=function(e){var t=e.editable(),n=c[0].firstChild;if(E.isImg(n)){for(var o=n.src,i=atob(o.split(",")[1]),r=new Uint8Array(i.length),a=0;a<i.length;a++)r[a]=i.charCodeAt(a);var s=new Blob([r],{type:"image/png"});s.name="clipboard.png",d.invoke("restoreRange",t),d.invoke("focus",t),d.insertImages(e,[s])}else{var l=P("<div />").html(c.html()).html();d.invoke("restoreRange",t),d.invoke("focus",t),l&&d.invoke("pasteHTML",t,l)}c.empty()},e=function(e){var t=e.originalEvent.clipboardData,n=E.makeLayoutInfo(e.currentTarget||e.target),o=n.editable();if(t&&t.items&&t.items.length){var i=v.head(t.items);"file"===i.kind&&-1!==i.type.indexOf("image/")&&d.insertImages(n,[i.getAsFile()]),d.invoke("editor.afterCommand",o)}}}function Le(s){function l(e,t){e.toggleClass("disabled",!t),e.attr("disabled",!t)}function d(e,t){e.on("keypress",function(e){e.keyCode===we.code.ENTER&&t.trigger("click")})}this.showLinkDialog=function(e,a,s){return P.Deferred(function(t){var n=a.find(".note-link-dialog"),o=n.find(".note-link-text"),i=n.find(".note-link-url"),e=n.find(".note-link-btn"),r=n.find("input[type=checkbox]");n.one("shown.bs.modal",function(){o.val(s.text),o.on("input",function(){l(e,o.val()&&i.val()),s.text=o.val()}),s.url||(s.url=s.text||"http://",l(e,s.text)),i.on("input",function(){l(e,o.val()&&i.val()),s.text||o.val(i.val())}).val(s.url).trigger("focus").trigger("select"),d(i,e),d(o,e),r.prop("checked",s.isNewWindow),e.one("click",function(e){e.preventDefault(),t.resolve({range:s.range,url:i.val(),text:o.val(),isNewWindow:r.is(":checked")}),n.modal("hide")})}).one("hidden.bs.modal",function(){o.off("input keypress"),i.off("input keypress"),e.off("click"),"pending"===t.state()&&t.reject()}).modal("show")}).promise()},this.show=function(e){var t=e.editor(),n=e.dialog(),o=e.editable(),i=e.popover(),r=s.invoke("editor.getLinkInfo",o),a=t.data("options");s.invoke("editor.saveRange",o),this.showLinkDialog(o,n,r).then(function(e){s.invoke("editor.restoreRange",o),s.invoke("editor.createLink",o,e,a),s.invoke("popover.hide",i)}).fail(function(){s.invoke("editor.restoreRange",o)})}}function Ee(o){this.show=function(t){var e=t.dialog(),n=t.editable();o.invoke("editor.saveRange",n),this.showImageDialog(n,e).then(function(e){o.invoke("editor.restoreRange",n),"string"==typeof e?o.invoke("editor.insertImage",n,e):o.insertImages(t,e)}).fail(function(){o.invoke("editor.restoreRange",n)})},this.showImageDialog=function(e,r){return P.Deferred(function(t){var n=r.find(".note-image-dialog"),e=r.find(".note-image-input"),o=r.find(".note-image-url"),i=r.find(".note-image-btn");n.one("shown.bs.modal",function(){e.replaceWith(e.clone().on("change",function(){t.resolve(this.files||this.value),n.modal("hide")}).val("")),i.click(function(e){e.preventDefault(),t.resolve(o.val()),n.modal("hide")}),o.on("keyup paste",function(e){var t;t="paste"===e.type?e.originalEvent.clipboardData.getData("text"):o.val(),function(e,t){e.toggleClass("disabled",!t),e.attr("disabled",!t)}(i,t)}).val("").trigger("focus"),function(e,t){e.on("keypress",function(e){e.keyCode===we.code.ENTER&&t.trigger("click")})}(o,i)}).one("hidden.bs.modal",function(){e.off("change"),o.off("keyup paste keypress"),i.off("click"),"pending"===t.state()&&t.reject()}).modal("show")})}}function Fe(o){this.showHelpDialog=function(e,t){return P.Deferred(function(e){t.find(".note-help-dialog").one("hidden.bs.modal",function(){e.resolve()}).modal("show")}).promise()},this.show=function(e){var t=e.dialog(),n=e.editable();o.invoke("editor.saveRange",n,!0),this.showHelpDialog(n,t).then(function(){o.invoke("editor.restoreRange",n)})}}P.summernote=P.summernote||{},P.extend(P.summernote,{version:"0.6.16",options:{width:null,height:null,minHeight:null,maxHeight:null,focus:!1,tabsize:4,styleWithSpan:!0,disableLinkTarget:!1,disableDragAndDrop:!1,disableResizeEditor:!1,disableResizeImage:!1,shortcuts:!0,textareaAutoSync:!0,placeholder:!1,prettifyHtml:!0,iconPrefix:"fa fa-",icons:{font:{bold:"bold",italic:"italic",underline:"underline",clear:"eraser",height:"text-height",strikethrough:"strikethrough",superscript:"superscript",subscript:"subscript"},image:{image:"image",floatLeft:"align-left",floatRight:"align-right",floatNone:"align-justify",shapeRounded:"square",shapeCircle:"circle-o",shapeThumbnail:"image",shapeNone:"times",remove:"trash-o"},link:{link:"link",unlink:"unlink",edit:"edit"},table:{table:"table"},hr:{insert:"minus"},style:{style:"magic"},lists:{unordered:"list-ul",ordered:"list-ol"},options:{help:"question",fullscreen:"arrows-alt",codeview:"code"},paragraph:{paragraph:"align-left",outdent:"outdent",indent:"indent",left:"align-left",center:"align-center",right:"align-right",justify:"align-justify"},color:{recent:"font"},history:{undo:"undo",redo:"repeat"},misc:{check:"check"}},dialogsInBody:!1,codemirror:{mode:"text/html",htmlMode:!0,lineNumbers:!0},lang:"en-US",direction:null,toolbar:[["style",["style"]],["font",["bold","italic","underline","clear"]],["fontname",["fontname"]],["fontsize",["fontsize"]],["color",["color"]],["para",["ul","ol","paragraph"]],["height",["height"]],["table",["table"]],["insert",["link","picture","hr"]],["view",["fullscreen","codeview"]],["help",["help"]]],plugin:{},airMode:!1,airPopover:[["color",["color"]],["font",["bold","underline","clear"]],["para",["ul","paragraph"]],["table",["table"]],["insert",["link","picture"]]],styleTags:["p","blockquote","pre","h1","h2","h3","h4","h5","h6"],defaultFontName:"Helvetica Neue",fontNames:["Arial","Arial Black","Comic Sans MS","Courier New","Helvetica Neue","Helvetica","Impact","Lucida Grande","Tahoma","Times New Roman","Verdana"],fontNamesIgnoreCheck:[],fontSizes:["8","9","10","11","12","14","18","24","36"],colors:[["#000000","#424242","#636363","#9C9C94","#CEC6CE","#EFEFEF","#F7F7F7","#FFFFFF"],["#FF0000","#FF9C00","#FFFF00","#00FF00","#00FFFF","#0000FF","#9C00FF","#FF00FF"],["#F7C6CE","#FFE7CE","#FFEFC6","#D6EFD6","#CEDEE7","#CEE7F7","#D6D6E7","#E7D6DE"],["#E79C9C","#FFC69C","#FFE79C","#B5D6A5","#A5C6CE","#9CC6EF","#B5A5D6","#D6A5BD"],["#E76363","#F7AD6B","#FFD663","#94BD7B","#73A5AD","#6BADDE","#8C7BC6","#C67BA5"],["#CE0000","#E79439","#EFC631","#6BA54A","#4A7B8C","#3984C6","#634AA5","#A54A7B"],["#9C0000","#B56308","#BD9400","#397B21","#104A5A","#085294","#311873","#731842"],["#630000","#7B3900","#846300","#295218","#083139","#003163","#21104A","#4A1031"]],lineHeights:["1.0","1.2","1.4","1.5","1.6","1.8","2.0","3.0"],insertTableMaxSize:{col:10,row:10},maximumImageFileSize:null,oninit:null,onfocus:null,onblur:null,onenter:null,onkeyup:null,onkeydown:null,onImageUpload:null,onImageUploadError:null,onMediaDelete:null,onToolbarClick:null,onsubmit:null,onCreateLink:function(e){return-1!==e.indexOf("@")&&-1===e.indexOf(":")&&(e="mailto:"+e),e},keyMap:{pc:{ENTER:"insertParagraph","CTRL+Z":"undo","CTRL+Y":"redo",TAB:"tab","SHIFT+TAB":"untab","CTRL+B":"bold","CTRL+I":"italic","CTRL+U":"underline","CTRL+SHIFT+S":"strikethrough","CTRL+BACKSLASH":"removeFormat","CTRL+SHIFT+L":"justifyLeft","CTRL+SHIFT+E":"justifyCenter","CTRL+SHIFT+R":"justifyRight","CTRL+SHIFT+J":"justifyFull","CTRL+SHIFT+NUM7":"insertUnorderedList","CTRL+SHIFT+NUM8":"insertOrderedList","CTRL+LEFTBRACKET":"outdent","CTRL+RIGHTBRACKET":"indent","CTRL+NUM0":"formatPara","CTRL+NUM1":"formatH1","CTRL+NUM2":"formatH2","CTRL+NUM3":"formatH3","CTRL+NUM4":"formatH4","CTRL+NUM5":"formatH5","CTRL+NUM6":"formatH6","CTRL+ENTER":"insertHorizontalRule","CTRL+K":"showLinkDialog"},mac:{ENTER:"insertParagraph","CMD+Z":"undo","CMD+SHIFT+Z":"redo",TAB:"tab","SHIFT+TAB":"untab","CMD+B":"bold","CMD+I":"italic","CMD+U":"underline","CMD+SHIFT+S":"strikethrough","CMD+BACKSLASH":"removeFormat","CMD+SHIFT+L":"justifyLeft","CMD+SHIFT+E":"justifyCenter","CMD+SHIFT+R":"justifyRight","CMD+SHIFT+J":"justifyFull","CMD+SHIFT+NUM7":"insertUnorderedList","CMD+SHIFT+NUM8":"insertOrderedList","CMD+LEFTBRACKET":"outdent","CMD+RIGHTBRACKET":"indent","CMD+NUM0":"formatPara","CMD+NUM1":"formatH1","CMD+NUM2":"formatH2","CMD+NUM3":"formatH3","CMD+NUM4":"formatH4","CMD+NUM5":"formatH5","CMD+NUM6":"formatH6","CMD+ENTER":"insertHorizontalRule","CMD+K":"showLinkDialog"}}},lang:{"en-US":{font:{bold:"Bold",italic:"Italic",underline:"Underline",clear:"Remove Font Style",height:"Line Height",name:"Font Family",strikethrough:"Strikethrough",subscript:"Subscript",superscript:"Superscript",size:"Font Size"},image:{image:"Picture",insert:"Insert Image",resizeFull:"Resize Full",resizeHalf:"Resize Half",resizeQuarter:"Resize Quarter",floatLeft:"Float Left",floatRight:"Float Right",floatNone:"Float None",shapeRounded:"Shape: Rounded",shapeCircle:"Shape: Circle",shapeThumbnail:"Shape: Thumbnail",shapeNone:"Shape: None",dragImageHere:"Drag image or text here",dropImage:"Drop image or Text",selectFromFiles:"Select from files",maximumFileSize:"Maximum file size",maximumFileSizeError:"Maximum file size exceeded.",url:"Image URL",remove:"Remove Image"},link:{link:"Link",insert:"Insert Link",unlink:"Unlink",edit:"Edit",textToDisplay:"Text to display",url:"To what URL should this link go?",openInNewWindow:"Open in new window"},table:{table:"Table"},hr:{insert:"Insert Horizontal Rule"},style:{style:"Style",normal:"Normal",blockquote:"Quote",pre:"Code",h1:"Header 1",h2:"Header 2",h3:"Header 3",h4:"Header 4",h5:"Header 5",h6:"Header 6"},lists:{unordered:"Unordered list",ordered:"Ordered list"},options:{help:"Help",fullscreen:"Full Screen",codeview:"Code View"},paragraph:{paragraph:"Paragraph",outdent:"Outdent",indent:"Indent",left:"Align left",center:"Align center",right:"Align right",justify:"Justify full"},color:{recent:"Recent Color",more:"More Color",background:"Background Color",foreground:"Foreground Color",transparent:"Transparent",setTransparent:"Set transparent",reset:"Reset",resetToDefault:"Reset to default"},shortcut:{shortcuts:"Keyboard shortcuts",close:"Close",textFormatting:"Text formatting",action:"Action",paragraphFormatting:"Paragraph formatting",documentStyle:"Document Style",extraKeys:"Extra keys"},history:{undo:"Undo",redo:"Redo"}}}});var Ie=new function(){function g(e,t){var n=t.event,o=t.value,i=t.title,r=t.className,a=t.dropdown,s=t.hide;return(a?'<div class="btn-group'+(r?" "+r:"")+'">':"")+'<button type="button" class="btn btn-default btn-sm'+(!a&&r?" "+r:"")+(a?" dropdown-toggle":"")+'"'+(a?' data-toggle="dropdown"':"")+(i?' title="'+i+'"':"")+(n?' data-event="'+n+'"':"")+(o?" data-value='"+o+"'":"")+(s?" data-hide='"+s+"'":"")+' tabindex="-1">'+e+(a?' <span class="caret"></span>':"")+"</button>"+(a||"")+(a?"</div>":"")}function b(e,t){return g('<i class="'+e+'"></i>',t)}function y(e,t){var n=P('<div class="'+e+' popover bottom in" style="display: none;"><div class="arrow"></div><div class="popover-content"></div></div>');return n.find(".popover-content").append(t),n}function s(e,t,n,o){return'<div class="'+e+' modal" aria-hidden="false"><div class="modal-dialog"><div class="modal-content">'+(t?'<div class="modal-header"><button type="button" class="close" aria-hidden="true" tabindex="-1">&times;</button><h4 class="modal-title">'+t+"</h4></div>":"")+'<div class="modal-body">'+n+"</div>"+(o?'<div class="modal-footer">'+o+"</div>":"")+"</div></div></div>"}function l(e,t,n){var o="dropdown-menu"+(t?" "+t:"");return n=n||"ul",e instanceof Array&&(e=e.join("")),"<"+n+' class="'+o+'">'+e+"</"+n+">"}function k(l,d){var e,t,n,o,i,r,a,s,c,u,f,h,p,v,m=P('<div class="note-popover" />');return m.append((e=b(d.iconPrefix+d.icons.link.edit,{title:l.link.edit,event:"showLinkDialog",hide:!0}),t=b(d.iconPrefix+d.icons.link.unlink,{title:l.link.unlink,event:"unlink"}),y("note-link-popover",'<a href="http://www.google.com" target="_blank">www.google.com</a>&nbsp;&nbsp;<div class="note-insert btn-group">'+e+t+"</div>"))),m.append((n=g('<span class="note-fontsize-10">100%</span>',{title:l.image.resizeFull,event:"resize",value:"1"}),o=g('<span class="note-fontsize-10">50%</span>',{title:l.image.resizeHalf,event:"resize",value:"0.5"}),i=g('<span class="note-fontsize-10">25%</span>',{title:l.image.resizeQuarter,event:"resize",value:"0.25"}),r=b(d.iconPrefix+d.icons.image.floatLeft,{title:l.image.floatLeft,event:"floatMe",value:"left"}),a=b(d.iconPrefix+d.icons.image.floatRight,{title:l.image.floatRight,event:"floatMe",value:"right"}),s=b(d.iconPrefix+d.icons.image.floatNone,{title:l.image.floatNone,event:"floatMe",value:"none"}),c=b(d.iconPrefix+d.icons.image.shapeRounded,{title:l.image.shapeRounded,event:"imageShape",value:"img-rounded"}),u=b(d.iconPrefix+d.icons.image.shapeCircle,{title:l.image.shapeCircle,event:"imageShape",value:"img-circle"}),f=b(d.iconPrefix+d.icons.image.shapeThumbnail,{title:l.image.shapeThumbnail,event:"imageShape",value:"img-thumbnail"}),h=b(d.iconPrefix+d.icons.image.shapeNone,{title:l.image.shapeNone,event:"imageShape",value:""}),p=b(d.iconPrefix+d.icons.image.remove,{title:l.image.remove,event:"removeMedia",value:"none"}),v=(d.disableResizeImage?"":'<div class="btn-group">'+n+o+i+"</div>")+'<div class="btn-group">'+r+a+s+'</div><br><div class="btn-group">'+c+u+f+h+'</div><div class="btn-group">'+p+"</div>",y("note-image-popover",v))),d.airMode&&m.append(function(){for(var e=P("<div />"),t=0,n=d.airPopover.length;t<n;t++){for(var o=d.airPopover[t],i=P('<div class="note-'+o[0]+' btn-group">'),r=0,a=o[1].length;r<a;r++){var s=P(S[o[1][r]](l,d));s.attr("data-name",o[1][r]),i.append(s)}e.append(i)}return y("note-air-popover",e.children())}()),m}function x(e){return'<div class="note-handle"><div class="note-control-selection"><div class="note-control-selection-bg"></div><div class="note-control-holder note-control-nw"></div><div class="note-control-holder note-control-ne"></div><div class="note-control-holder note-control-sw"></div><div class="'+(e.disableResizeImage?"note-control-holder":"note-control-sizing")+' note-control-se"></div>'+(e.disableResizeImage?"":'<div class="note-control-selection-info"></div>')+"</div></div>"}function r(e,t){var n="note-shortcut-col col-xs-6 note-shortcut-",o=[];for(var i in t)t.hasOwnProperty(i)&&o.push('<div class="'+n+'key">'+t[i].kbd+'</div><div class="'+n+'name">'+t[i].text+"</div>");return'<div class="note-shortcut-row row"><div class="'+n+'title col-xs-offset-6">'+e+'</div></div><div class="note-shortcut-row row">'+o.join('</div><div class="note-shortcut-row row">')+"</div>"}function o(e,t){var n='class="note-shortcut note-shortcut-col col-sm-6 col-xs-12"',o=["<div "+n+">"+function(e){var t=[{kbd:" + Z",text:e.history.undo},{kbd:" +  + Z",text:e.history.redo},{kbd:" + ]",text:e.paragraph.indent},{kbd:" + [",text:e.paragraph.outdent},{kbd:" + ENTER",text:e.hr.insert}];return r(e.shortcut.action,t)}(e)+"</div><div "+n+">"+function(e){var t=[{kbd:" + B",text:e.font.bold},{kbd:" + I",text:e.font.italic},{kbd:" + U",text:e.font.underline},{kbd:" + \\",text:e.font.clear}];return r(e.shortcut.textFormatting,t)}(e)+"</div>","<div "+n+">"+function(e){var t=[{kbd:" + NUM0",text:e.style.normal},{kbd:" + NUM1",text:e.style.h1},{kbd:" + NUM2",text:e.style.h2},{kbd:" + NUM3",text:e.style.h3},{kbd:" + NUM4",text:e.style.h4},{kbd:" + NUM5",text:e.style.h5},{kbd:" + NUM6",text:e.style.h6}];return r(e.shortcut.documentStyle,t)}(e)+"</div><div "+n+">"+function(e){var t=[{kbd:" +  + L",text:e.paragraph.left},{kbd:" +  + E",text:e.paragraph.center},{kbd:" +  + R",text:e.paragraph.right},{kbd:" +  + J",text:e.paragraph.justify},{kbd:" +  + NUM7",text:e.lists.ordered},{kbd:" +  + NUM8",text:e.lists.unordered}];return r(e.shortcut.paragraphFormatting,t)}(e)+"</div>"];return t.extraKeys&&o.push("<div "+n+">"+function(e,t){var n=t.extraKeys,o=[];for(var i in n)n.hasOwnProperty(i)&&o.push({kbd:i,text:n[i]});return r(e.shortcut.extraKeys,o)}(e,t)+"</div>"),'<div class="note-shortcut-row row">'+o.join('</div><div class="note-shortcut-row row">')+"</div>"}function w(n,o){var i="";return P.each(a,function(e,t){i+=t(n,o)}),'<div class="note-dialog">'+i+"</div>"}function N(e,t,n){var i=p.invertObject(t);e.find("button").each(function(e,t){var n=P(t),o=i[n.data("event")];o&&n.attr("title",function(e,t){return t+" ("+function(e){return L.isMac&&(e=e.replace("CMD","").replace("SHIFT","")),e.replace("BACKSLASH","\\").replace("SLASH","/").replace("LEFTBRACKET","[").replace("RIGHTBRACKET","]")}(o)+")"})}).b_tooltip({container:"body",trigger:"hover",placement:n||"top"}).on("click",function(){P(this).b_tooltip("hide")})}function T(e,t){var c=t.colors;e.find(".note-color-palette").each(function(){for(var e=P(this),t=e.attr("data-target-event"),n=[],o=0,i=c.length;o<i;o++){for(var r=c[o],a=[],s=0,l=r.length;s<l;s++){var d=r[s];a.push(['<button type="button" class="note-color-btn" style="background-color:',d,';" data-event="',t,'" data-value="',d,'" title="',d,'" data-toggle="button" tabindex="-1"></button>'].join(""))}n.push('<div class="note-color-row">'+a.join("")+"</div>")}e.html(n.join(""))})}var S={picture:function(e,t){return b(t.iconPrefix+t.icons.image.image,{event:"showImageDialog",title:e.image.image,hide:!0})},link:function(e,t){return b(t.iconPrefix+t.icons.link.link,{event:"showLinkDialog",title:e.link.link,hide:!0})},table:function(e,t){return b(t.iconPrefix+t.icons.table.table,{title:e.table.table,dropdown:l(['<div class="note-dimension-picker">','<div class="note-dimension-picker-mousecatcher" data-event="insertTable" data-value="1x1"></div>','<div class="note-dimension-picker-highlighted"></div>','<div class="note-dimension-picker-unhighlighted"></div>',"</div>",'<div class="note-dimension-display"> 1 x 1 </div>'],"note-table")})},style:function(o,e){var t=e.styleTags.reduce(function(e,t){var n=o.style["p"===t?"normal":t];return e+'<li><a data-event="formatBlock" href="#" data-value="'+t+'">'+("p"===t||"pre"===t?n:"<"+t+">"+n+"</"+t+">")+"</a></li>"},"");return b(e.iconPrefix+e.icons.style.style,{title:o.style.style,dropdown:l(t)})},fontname:function(e,n){var o=[],t=n.fontNames.reduce(function(e,t){return L.isFontInstalled(t)||v.contains(n.fontNamesIgnoreCheck,t)?(o.push(t),e+'<li><a data-event="fontName" href="#" data-value="'+t+'" style="font-family:\''+t+'\'"><i class="'+n.iconPrefix+n.icons.misc.check+'"></i> '+t+"</a></li>"):e},""),i=L.isFontInstalled(n.defaultFontName)?n.defaultFontName:o[0];return g('<span class="note-current-fontname">'+i+"</span>",{title:e.font.name,className:"note-fontname",dropdown:l(t,"note-check")})},fontsize:function(e,n){var t=n.fontSizes.reduce(function(e,t){return e+'<li><a data-event="fontSize" href="#" data-value="'+t+'"><i class="'+n.iconPrefix+n.icons.misc.check+'"></i> '+t+"</a></li>"},"");return g('<span class="note-current-fontsize">11</span>',{title:e.font.size,className:"note-fontsize",dropdown:l(t,"note-check")})},color:function(e,t){var n='<i class="'+t.iconPrefix+t.icons.color.recent+'" style="color:black;background-color:yellow;"></i>',o=g(n,{className:"note-recent-color",title:e.color.recent,event:"color",value:'{"backColor":"yellow"}'}),i=['<li><div class="btn-group">','<div class="note-palette-title">'+e.color.background+"</div>",'<div class="note-color-reset" data-event="backColor"',' data-value="inherit" title="'+e.color.transparent+'">'+e.color.setTransparent+"</div>",'<div class="note-color-palette" data-target-event="backColor"></div>','</div><div class="btn-group">','<div class="note-palette-title">'+e.color.foreground+"</div>",'<div class="note-color-reset" data-event="foreColor" data-value="inherit" title="'+e.color.reset+'">',e.color.resetToDefault,"</div>",'<div class="note-color-palette" data-target-event="foreColor"></div>',"</div></li>"];return o+g("",{title:e.color.more,dropdown:l(i)})},bold:function(e,t){return b(t.iconPrefix+t.icons.font.bold,{event:"bold",title:e.font.bold})},italic:function(e,t){return b(t.iconPrefix+t.icons.font.italic,{event:"italic",title:e.font.italic})},underline:function(e,t){return b(t.iconPrefix+t.icons.font.underline,{event:"underline",title:e.font.underline})},strikethrough:function(e,t){return b(t.iconPrefix+t.icons.font.strikethrough,{event:"strikethrough",title:e.font.strikethrough})},superscript:function(e,t){return b(t.iconPrefix+t.icons.font.superscript,{event:"superscript",title:e.font.superscript})},subscript:function(e,t){return b(t.iconPrefix+t.icons.font.subscript,{event:"subscript",title:e.font.subscript})},clear:function(e,t){return b(t.iconPrefix+t.icons.font.clear,{event:"removeFormat",title:e.font.clear})},ul:function(e,t){return b(t.iconPrefix+t.icons.lists.unordered,{event:"insertUnorderedList",title:e.lists.unordered})},ol:function(e,t){return b(t.iconPrefix+t.icons.lists.ordered,{event:"insertOrderedList",title:e.lists.ordered})},paragraph:function(e,t){var n=b(t.iconPrefix+t.icons.paragraph.left,{title:e.paragraph.left,event:"justifyLeft"}),o=b(t.iconPrefix+t.icons.paragraph.center,{title:e.paragraph.center,event:"justifyCenter"}),i=b(t.iconPrefix+t.icons.paragraph.right,{title:e.paragraph.right,event:"justifyRight"}),r=b(t.iconPrefix+t.icons.paragraph.justify,{title:e.paragraph.justify,event:"justifyFull"}),a=b(t.iconPrefix+t.icons.paragraph.outdent,{title:e.paragraph.outdent,event:"outdent"}),s=['<div class="note-align btn-group">',n+o+i+r,'</div><div class="note-list btn-group">',b(t.iconPrefix+t.icons.paragraph.indent,{title:e.paragraph.indent,event:"indent"})+a,"</div>"];return b(t.iconPrefix+t.icons.paragraph.paragraph,{title:e.paragraph.paragraph,dropdown:l(s,"","div")})},height:function(e,n){var t=n.lineHeights.reduce(function(e,t){return e+'<li><a data-event="lineHeight" href="#" data-value="'+parseFloat(t)+'"><i class="'+n.iconPrefix+n.icons.misc.check+'"></i> '+t+"</a></li>"},"");return b(n.iconPrefix+n.icons.font.height,{title:e.font.height,dropdown:l(t,"note-check")})},help:function(e,t){return b(t.iconPrefix+t.icons.options.help,{event:"showHelpDialog",title:e.options.help,hide:!0})},fullscreen:function(e,t){return b(t.iconPrefix+t.icons.options.fullscreen,{event:"fullscreen",title:e.options.fullscreen})},codeview:function(e,t){return b(t.iconPrefix+t.icons.options.codeview,{event:"codeview",title:e.options.codeview})},undo:function(e,t){return b(t.iconPrefix+t.icons.history.undo,{event:"undo",title:e.history.undo})},redo:function(e,t){return b(t.iconPrefix+t.icons.history.redo,{event:"redo",title:e.history.redo})},hr:function(e,t){return b(t.iconPrefix+t.icons.hr.insert,{event:"insertHorizontalRule",title:e.hr.insert})}},a={image:function(e,t){var n="";if(t.maximumImageFileSize){var o=Math.floor(Math.log(t.maximumImageFileSize)/Math.log(1024)),i=1*(t.maximumImageFileSize/Math.pow(1024,o)).toFixed(2)+" "+" KMGTP"[o]+"B";n="<small>"+e.image.maximumFileSize+" : "+i+"</small>"}var r='<div class="form-group row note-group-select-from-files" style="display: none;"><label>'+e.image.selectFromFiles+'</label><input class="note-image-input form-control" type="file" name="files" accept="image/*" multiple="multiple" />'+n+'</div><div class="form-group row"><label>'+e.image.url+'</label><br/><input class="note-image-url form-control col-md-12" type="text" style="width: 400px !important;margin-right: 18px;" /><a class="btn btn-default imageBtn" style=" display: inline-block; margin: 0px;">'+e.image.selectFromFiles+"</a></div>",a='<button href="#" class="btn btn-primary note-image-btn disabled" disabled>'+e.image.insert+"</button>";return s("note-image-dialog",e.image.insert,r,a)},link:function(e,t){var n='<div class="form-group row"><label>'+e.link.textToDisplay+'</label><input class="note-link-text form-control col-md-12" type="text" /></div><div class="form-group row"><label>'+e.link.url+'</label><input class="note-link-url form-control col-md-12" type="text" value="http://" /></div>'+(t.disableLinkTarget?"":'<div class="checkbox"><label><input type="checkbox" checked> '+e.link.openInNewWindow+"</label></div>"),o='<button href="#" class="btn btn-primary note-link-btn disabled" disabled>'+e.link.insert+"</button>";return s("note-link-dialog",e.link.insert,n,o)},help:function(e,t){var n='<a class="modal-close pull-right" aria-hidden="true" tabindex="-1">'+e.shortcut.close+'</a><div class="title">'+e.shortcut.shortcuts+"</div>"+(L.isMac?o(e,t):function(e){return e.replace(//g,"Ctrl").replace(//g,"Shift")}(o(e,t)))+'<p class="text-center"><a href="//summernote.org/" target="_blank">Summernote 0.6.16</a>  <a href="//github.com/summernote/summernote" target="_blank">Project</a>  <a href="//github.com/summernote/summernote/issues" target="_blank">Issues</a></p>';return s("note-help-dialog","",n,"")}};this.createLayoutByAirMode=function(e,t){var n=t.langInfo,o=t.keyMap[L.isMac?"mac":"pc"],i=p.uniqueId();e.addClass("note-air-editor note-editable panel-body"),e.attr({id:"note-editor-"+i,contentEditable:!0});var r=document.body,a=P(k(n,t));a.addClass("note-air-layout"),a.attr("id","note-popover-"+i),a.appendTo(r),N(a,o),T(a,t);var s=P(x(t));s.addClass("note-air-layout"),s.attr("id","note-handle-"+i),s.appendTo(r);var l=P(w(n,t));l.addClass("note-air-layout"),l.attr("id","note-dialog-"+i),l.find("button.close, a.modal-close").click(function(){P(this).closest(".modal").modal("hide")}),l.appendTo(r)},this.createLayoutByFrame=function(e,t){var n=t.langInfo,o=P('<div class="note-editor panel panel-default" />');t.width&&o.width(t.width),0<t.height&&P('<div class="note-statusbar">'+(t.disableResizeEditor?"":'<div class="note-resizebar"><div class="note-icon-bar"></div><div class="note-icon-bar"></div><div class="note-icon-bar"></div></div>')+"</div>").prependTo(o);var i=P('<div class="note-editing-area" />'),r=!e.is(":disabled"),a=P('<div class="note-editable panel-body" contentEditable="'+r+'"></div>').prependTo(i);t.height&&a.height(t.height),t.direction&&a.attr("dir",t.direction);var s=e.attr("placeholder")||t.placeholder;s&&a.attr("data-placeholder",s),a.html(E.html(e)||E.emptyPara),P('<textarea class="note-codable"></textarea>').prependTo(i);var l=P(k(n,t)).prependTo(i);T(l,t),N(l,y),P(x(t)).prependTo(i),i.prependTo(o);for(var d=P('<div class="note-toolbar panel-heading" />'),c=0,u=t.toolbar.length;c<u;c++){for(var f=t.toolbar[c][0],h=t.toolbar[c][1],p=P('<div class="note-'+f+' btn-group" />'),v=0,m=h.length;v<m;v++){var g=S[h[v]];if(P.isFunction(g)){var b=P(g(n,t));b.attr("data-name",h[v]),p.append(b)}}d.append(p)}var y=t.keyMap[L.isMac?"mac":"pc"];T(d,t),N(d,y,"bottom"),d.prependTo(o),P('<div class="note-dropzone"><div class="note-dropzone-message"></div></div>').prependTo(o);var C=t.dialogsInBody?P(document.body):o;P(w(n,t)).prependTo(C).find("button.close, a.modal-close").click(function(){P(this).closest(".modal").modal("hide")}),o.insertAfter(e),e.hide()},this.hasNoteEditor=function(e){return 0<this.noteEditorFromHolder(e).length},this.noteEditorFromHolder=function(e){return e.hasClass("note-air-editor")?e:e.next().hasClass("note-editor")?e.next():P()},this.createLayout=function(e,t){t.airMode?this.createLayoutByAirMode(e,t):this.createLayoutByFrame(e,t)},this.layoutInfoFromHolder=function(e){var t=this.noteEditorFromHolder(e);if(t.length)return t.data("holder",e),E.buildLayoutInfo(t)},this.removeLayout=function(e,t,n){n.airMode?(e.removeClass("note-air-editor note-editable").removeAttr("id contentEditable"),t.popover().remove(),t.handle().remove(),t.dialog().remove()):(e.html(t.editable().html()),n.dialogsInBody&&t.dialog().remove(),t.editor().remove(),e.show())},this.getTemplate=function(){return{button:g,iconButton:b,dialog:s}},this.addButtonInfo=function(e,t){S[e]=t},this.addDialogInfo=function(e,t){a[e]=t}},Me=new function(){var o=this,c=this.modules={editor:new he(this),toolbar:new ve(this),statusbar:new me(this),popover:new ge(this),handle:new be(this),fullscreen:new ye(this),codeview:new Te(this),dragAndDrop:new Se(this),clipboard:new Pe(this),linkDialog:new Le(this),imageDialog:new Ee(this),helpDialog:new Fe(this)};this.invoke=function(){var e=v.head(v.from(arguments)),t=v.tail(v.from(arguments)),n=e.split("."),o=1<n.length,i=o&&v.head(n),r=o?v.last(n):v.head(n),a=this.getModule(i),s=a[r];return s&&s.apply(a,t)},this.getModule=function(e){return this.modules[e]||this.modules.editor};var l=this.bindCustomEvent=function(t,n,o){return function(){var e=n[p.namespaceToCamel(o,"on")];return e&&e.apply(t[0],arguments),t.trigger("summernote."+o,arguments)}};this.insertImages=function(e,t){var n=e.editor(),o=e.editable(),i=e.holder(),r=o.data("callbacks"),a=n.data("options");r.onImageUpload?l(i,r,"image.upload")(t):P.each(t,function(e,t){var n=t.name;a.maximumImageFileSize&&a.maximumImageFileSize<t.size?l(i,r,"image.upload.error")(a.langInfo.image.maximumFileSizeError):xe.readFileAsDataURL(t).then(function(e){c.editor.insertImage(o,e,n)}).fail(function(){l(i,r,"image.upload.error")(a.langInfo.image.maximumFileSizeError)})})};function i(e){E.isImg(e.target)&&e.preventDefault()}function r(e){var t=E.makeLayoutInfo(e.currentTarget||e.target);c.editor.removeBogus(t.editable()),f(e)}var u={showLinkDialog:function(e){c.linkDialog.show(e)},showImageDialog:function(e){c.imageDialog.show(e)},showHelpDialog:function(e){c.helpDialog.show(e)},fullscreen:function(e){c.fullscreen.toggle(e)},codeview:function(e){c.codeview.toggle(e)}};this.updateStyleInfo=function(e,t){if(e){var n=t.editor().data("options").airMode;n||c.toolbar.update(t.toolbar(),e),c.popover.update(t.popover(),e,n),c.handle.update(t.handle(),e,n)}};function a(e){var t=E.makeLayoutInfo(e.currentTarget||e.target);c.popover.hide(t.popover()),c.handle.hide(t.handle())}function s(e){P(e.target).closest("[data-event]").length&&e.preventDefault()}function d(e){var t=P(e.target).closest("[data-event]");if(t.length){var n,o=t.attr("data-event"),i=t.attr("data-value"),r=t.attr("data-hide"),a=E.makeLayoutInfo(e.target);if(-1!==P.inArray(o,["resize","floatMe","removeMedia","imageShape"])){var s=a.handle().find(".note-control-selection");n=P(s.data("target"))}if(r&&t.parents(".popover").hide(),P.isFunction(P.summernote.pluginEvents[o]))P.summernote.pluginEvents[o](e,c.editor,a,i);else if(c.editor[o]){var l=a.editable();l.focus(),c.editor[o](l,i,n),e.preventDefault()}else u[o]&&(u[o].call(this,a),e.preventDefault());if(-1!==P.inArray(o,["backColor","foreColor"])){var d=a.editor().data("options",d);(d.airMode?c.popover:c.toolbar).updateRecentColor(v.head(t),o,i)}f(e)}}var f=function(e){var n=e.target;setTimeout(function(){var e=E.makeLayoutInfo(n),t=c.editor.currentStyle(n);o.updateStyleInfo(t,e)},0)};this.bindKeyMap=function(a,s){var l=a.editor(),d=a.editable();d.on("keydown",function(e){var t=[];e.metaKey&&t.push("CMD"),e.ctrlKey&&!e.altKey&&t.push("CTRL"),e.shiftKey&&t.push("SHIFT");var n,o=we.nameFromCode[e.keyCode];o&&t.push(o);var i=t.join("+"),r=s[i];if(r){if(n=P.summernote.pluginEvents[i],P.isFunction(n)&&n(e,c.editor,a))return!1;n=P.summernote.pluginEvents[r],P.isFunction(n)?n(e,c.editor,a):c.editor[r]?(c.editor[r](d,l.data("options")),e.preventDefault()):u[r]&&(u[r].call(this,a),e.preventDefault())}else we.isEdit(e.keyCode)&&c.editor.afterCommand(d)})},this.attach=function(e,t){t.shortcuts&&this.bindKeyMap(e,t.keyMap[L.isMac?"mac":"pc"]),e.editable().on("mousedown",i),e.editable().on("keyup mouseup",r),e.editable().on("scroll",a),c.clipboard.attach(e,t),c.handle.attach(e,t),e.popover().on("click",d),e.popover().on("mousedown",s),c.dragAndDrop.attach(e,t),t.airMode||(e.toolbar().on("click",d),e.toolbar().on("mousedown",s),c.statusbar.attach(e,t)),(t.airMode?e.popover():e.toolbar()).find(".note-dimension-picker-mousecatcher").css({width:t.insertTableMaxSize.col+"em",height:t.insertTableMaxSize.row+"em"}).on("mousemove",function(e){!function(e,t){var n,o=P(e.target.parentNode),i=o.next(),r=o.find(".note-dimension-picker-mousecatcher"),a=o.find(".note-dimension-picker-highlighted"),s=o.find(".note-dimension-picker-unhighlighted");if(void 0===e.offsetX){var l=P(e.target).offset();n={x:e.pageX-l.left,y:e.pageY-l.top}}else n={x:e.offsetX,y:e.offsetY};var d=Math.ceil(n.x/18)||1,c=Math.ceil(n.y/18)||1;a.css({width:d+"em",height:c+"em"}),r.attr("data-value",d+"x"+c),3<d&&d<t.insertTableMaxSize.col&&s.css({width:d+1+"em"}),3<c&&c<t.insertTableMaxSize.row&&s.css({height:c+1+"em"}),i.html(d+" x "+c)}(e,t)}),e.editor().data("options",t),L.isMSIE||setTimeout(function(){document.execCommand("styleWithCSS",0,t.styleWithSpan)},0);var n=new le(e.editable());e.editable().data("NoteHistory",n),e.editable().data("callbacks",{onInit:t.onInit,onFocus:t.onFocus,onBlur:t.onBlur,onKeydown:t.onKeydown,onKeyup:t.onKeyup,onMousedown:t.onMousedown,onEnter:t.onEnter,onPaste:t.onPaste,onBeforeCommand:t.onBeforeCommand,onChange:t.onChange,onImageUpload:t.onImageUpload,onImageUploadError:t.onImageUploadError,onMediaDelete:t.onMediaDelete,onToolbarClick:t.onToolbarClick});var o=c.editor.styleFromNode(e.editable());this.updateStyleInfo(o,e)},this.attachCustomEvent=function(t,e){var n=t.holder(),o=t.editable(),i=o.data("callbacks");o.focus(l(n,i,"focus")),o.blur(l(n,i,"blur")),o.keydown(function(e){e.keyCode===we.code.ENTER&&l(n,i,"enter").call(this,e),l(n,i,"keydown").call(this,e)}),o.keyup(l(n,i,"keyup")),o.on("mousedown",l(n,i,"mousedown")),o.on("mouseup",l(n,i,"mouseup")),o.on("scroll",l(n,i,"scroll")),o.on("paste",l(n,i,"paste"));var r=L.isMSIE?"DOMCharacterDataModified DOMSubtreeModified DOMNodeInserted":"input";o.on(r,function(){l(n,i,"change")(o.html(),o)}),e.airMode||(t.toolbar().click(l(n,i,"toolbar.click")),t.popover().click(l(n,i,"popover.click"))),E.isTextarea(v.head(n))&&n.closest("form").submit(function(e){t.holder().val(t.holder().code()),l(n,i,"submit").call(this,e,n.code())}),E.isTextarea(v.head(n))&&e.textareaAutoSync&&n.on("summernote.change",function(){t.holder().val(t.holder().code())}),l(n,i,"init")(t);for(var a=0,s=P.summernote.plugins.length;a<s;a++)P.isFunction(P.summernote.plugins[a].init)&&P.summernote.plugins[a].init(t)},this.detach=function(e,t){e.holder().off(),e.editable().off(),e.popover().off(),e.handle().off(),e.dialog().off(),t.airMode||(e.dropzone().off(),e.toolbar().off(),e.statusbar().off())}};P.extend(P.summernote,{renderer:Ie,eventHandler:Me,core:{agent:L,list:v,dom:E,range:re},pluginEvents:{},plugins:[]}),P.summernote.addPlugin=function(e){P.summernote.plugins.push(e),e.buttons&&P.each(e.buttons,function(e,t){Ie.addButtonInfo(e,t)}),e.dialogs&&P.each(e.dialogs,function(e,t){Ie.addDialogInfo(e,t)}),e.events&&P.each(e.events,function(e,t){P.summernote.pluginEvents[e]=t}),e.langs&&P.each(e.langs,function(e,t){P.summernote.lang[e]&&P.extend(P.summernote.lang[e],t)}),e.options&&P.extend(P.summernote.options,e.options)},P.fn.extend({summernote:function(){var e=P.type(v.head(arguments)),t="string"===e,n="object"===e,i=n?v.head(arguments):{};if((i=P.extend({},P.summernote.options,i)).icons=P.extend({},P.summernote.options.icons,i.icons),i.langInfo=P.extend(!0,{},P.summernote.lang["en-US"],P.summernote.lang[i.lang]),!t&&n)for(var o=0,r=P.summernote.plugins.length;o<r;o++){var a=P.summernote.plugins[o];i.plugin[a.name]&&(P.summernote.plugins[o]=P.extend(!0,a,i.plugin[a.name]))}this.each(function(e,t){var n=P(t);if(!Ie.hasNoteEditor(n)){Ie.createLayout(n,i);var o=Ie.layoutInfoFromHolder(n);n.data("layoutInfo",o),Me.attach(o,i),Me.attachCustomEvent(o,i)}});var s=this.first();if(s.length){var l=Ie.layoutInfoFromHolder(s);if(t){var d=v.head(v.from(arguments)),c=v.tail(v.from(arguments)),u=[d,l.editable()].concat(c);return Me.invoke.apply(Me,u)}i.focus&&l.editable().focus()}return this},code:function(i){if(void 0!==i)return this.each(function(e,t){var n=Ie.layoutInfoFromHolder(P(t)),o=n&&n.editable();o&&o.html(i)}),this;var e=this.first();if(e.length){var t=Ie.layoutInfoFromHolder(e),n=t&&t.editable();if(n&&n.length){var o=Me.invoke("codeview.isActivated",t);return Me.invoke("codeview.sync",t),o?t.codable().val():t.editable().html()}return E.value(e)}},destroy:function(){return this.each(function(e,t){var n=P(t);if(Ie.hasNoteEditor(n)){var o=Ie.layoutInfoFromHolder(n),i=o.editor().data("options");Me.detach(o,i),Ie.removeLayout(n,o,i)}}),this}})});